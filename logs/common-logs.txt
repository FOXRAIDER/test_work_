2024-01-13T23:25:38.471802+0300 INFO  Request: GET http://127.0.0.1:8000/
2024-01-13T23:25:38.476924+0300 INFO  Response: 404
2024-01-13T23:25:38.556397+0300 INFO  Request: GET http://127.0.0.1:8000/favicon.ico
2024-01-13T23:25:38.558397+0300 INFO  Response: 404
2024-01-13T23:25:45.774550+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:25:45.776124+0300 INFO  Response: 200
2024-01-13T23:25:47.484639+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:25:47.487638+0300 INFO  Response: 200
2024-01-13T23:27:43.787560+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:27:43.791560+0300 INFO  Response: 200
2024-01-13T23:27:43.869853+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:27:43.872852+0300 INFO  Response: 200
2024-01-13T23:27:44.623397+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:27:44.624451+0300 INFO  Response: 200
2024-01-13T23:27:44.676224+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:27:44.677225+0300 INFO  Response: 200
2024-01-13T23:27:45.071872+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:27:45.072874+0300 INFO  Response: 200
2024-01-13T23:27:45.125173+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:27:45.127178+0300 INFO  Response: 200
2024-01-13T23:28:56.055519+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:28:56.060197+0300 INFO  Response: 200
2024-01-13T23:28:56.131355+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:28:56.137396+0300 INFO  Response: 200
2024-01-13T23:56:59.238527+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-13T23:56:59.241528+0300 INFO  Response: 200
2024-01-13T23:56:59.358435+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-13T23:56:59.364456+0300 INFO  Response: 200
2024-01-14T00:36:03.601199+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:36:03.605240+0300 INFO  Response: 200
2024-01-14T00:36:03.802564+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:36:03.806568+0300 INFO  Response: 200
2024-01-14T00:36:06.554562+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:36:11.366267+0300 ERROR  reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000246A40F6660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000246A40F6700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x00000246A2EE8EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x00000246A2EA3560>
           └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000246A2EA2AC0>
    └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000246A2EBB500>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
    │    └ <function subprocess_started at 0x00000246A3A2C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=936, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000246A3A3EEA0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=936, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000246A3A0B6A0>
           │       │   └ <uvicorn.server.Server object at 0x00000246A3A3EEA0>
           │       └ <function run at 0x00000246A2ED6C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000246A3A7C140>
           │      └ <function Runner.run at 0x00000246A3041EE0>
           └ <asyncio.runners.Runner object at 0x00000246A3A3E9C0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000246A30339C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000246A3A3E9C0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000246A3033920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000246A3041760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000246A2FA53A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000246A3A55640>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A66196D0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A6619...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000246A3A3CB60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000246A3A55640>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A66196D0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A6619...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A66196D0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A6619...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000246A6581FA0>
          └ <fastapi.applications.FastAPI object at 0x00000246A3A3CB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000246A6613EC0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A6619...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000246A6581FA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000246A65A5DA0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000246A6619460>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000246A6619460>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000246A65A5DA0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ArgumentError("reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not referen...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000246A661F100>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000246A6581E50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000246A661F100>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000246A6619910>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000246A6581E50>
          └ <function wrap_app_handling_exceptions at 0x00000246A53F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F060>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F060>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000246A655AF90>>
          └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F060>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000246A53F3560>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F060>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000246A65A5620>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F060>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000246A6619BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000246A661F380>
          └ <function wrap_app_handling_exceptions at 0x00000246A53F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A661F740>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A661F2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000246A661F380>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000246A6619BB0>
                     └ <function get_request_handler.<locals>.app at 0x00000246A65A5580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000246A068A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000246A6619130>}
                 │         └ <function add_start_data at 0x00000246A65256C0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000246A6581970>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000246A6619130>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x00000246A65EAA50>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x00000246A6568AF0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 246a6566d00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x00000246A65EAA50>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x00000246A6146FC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x00000246A613AF20>
    └ <Mapper at 0x246a655b9b0; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x00000246A64AF2F0>
    │                      └ <Mapper at 0x246a655b9b0; Brand>
    └ <function _configure_registries at 0x00000246A6146C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x00000246A6146D40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4240, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x00000246A613ADE0>
    └ <Mapper at 0x246a57ce9c0; Model>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2403, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x00000246A6013560>
    └ <Relationship at 0x246a656ad50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 579, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x00000246A6135800>
    └ <Relationship at 0x246a656ad50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1643, in do_init
    self._generate_backref()
    │    └ <function RelationshipProperty._generate_backref at 0x00000246A6136200>
    └ <Relationship at 0x246a656ad50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2129, in _generate_backref
    self._add_reverse_property(self.back_populates)
    │    │                     │    └ 'cars'
    │    │                     └ <Relationship at 0x246a656ad50; brand>
    │    └ <function RelationshipProperty._add_reverse_property at 0x00000246A6135620>
    └ <Relationship at 0x246a656ad50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1598, in _add_reverse_property
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.ArgumentError: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
2024-01-14T00:36:22.790798+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:36:22.791723+0300 ERROR  One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Model(models)]'. Original exception was: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000246A40F6660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000246A40F6700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x00000246A2EE8EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x00000246A2EA3560>
           └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000246A2EA2AC0>
    └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000246A2EBB500>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
    │    └ <function subprocess_started at 0x00000246A3A2C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=12812 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=936, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000246A3A3EEA0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=936, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000246A3A0B6A0>
           │       │   └ <uvicorn.server.Server object at 0x00000246A3A3EEA0>
           │       └ <function run at 0x00000246A2ED6C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000246A3A7C140>
           │      └ <function Runner.run at 0x00000246A3041EE0>
           └ <asyncio.runners.Runner object at 0x00000246A3A3E9C0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000246A30339C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000246A3A3E9C0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000246A3033920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000246A3041760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000246A2FA53A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000246A3A55640>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FCA40>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FC...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000246A3A3CB60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000246A3A55640>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FCA40>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FC...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FCA40>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FC...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000246A6581FA0>
          └ <fastapi.applications.FastAPI object at 0x00000246A3A3CB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000246A2E7F2E0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000246A68FC...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000246A6581FA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000246A664BA60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000246A68FC560>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000246A68FC560>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000246A664BA60>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggerin...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000246A67C4A40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000246A6581E50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000246A6581F40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000246A67C4A40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000246A68FCBF0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000246A6581E50>
          └ <function wrap_app_handling_exceptions at 0x00000246A53F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C4EA0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C4EA0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000246A655AF90>>
          └ <fastapi.routing.APIRouter object at 0x00000246A655AF90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C4EA0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000246A53F3560>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C4EA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000246A65A5620>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C4EA0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000246A68FCE90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000246A67C4F40>
          └ <function wrap_app_handling_exceptions at 0x00000246A53F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000246A67C5080>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000246A67C47C0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000246A67C4F40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000246A68FCE90>
                     └ <function get_request_handler.<locals>.app at 0x00000246A65A5580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000246A068A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000246A6619F10>}
                 │         └ <function add_start_data at 0x00000246A65256C0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000246A6581970>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000246A6619F10>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x00000246A68EF7D0>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x00000246A6568AF0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 246a6566d00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x00000246A68EF7D0>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x00000246A6146FC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x00000246A613AF20>
    └ <Mapper at 0x246a655b9b0; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x00000246A64AF2F0>
    │                      └ <Mapper at 0x246a655b9b0; Brand>
    └ <function _configure_registries at 0x00000246A6146C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x00000246A6146D40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4236, in _do_configure_registries
    raise e
          └ InvalidRequestError("One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggerin...

sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Model(models)]'. Original exception was: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
2024-01-14T00:36:47.252648+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:36:47.268721+0300 ERROR  reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000020135A46660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000020135A46700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 676
               │     └ 3
               └ <function _main at 0x0000020134838F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 676
           │    └ <function BaseProcess._bootstrap at 0x00000201347F3600>
           └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000201347F2B60>
    └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002013529ED20>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
    │    └ <function subprocess_started at 0x000002013537C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=556, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002013538ED50>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=556, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002013535B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002013538ED50>
           │       └ <function run at 0x0000020134826CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000201353CC240>
           │      └ <function Runner.run at 0x0000020134991F80>
           └ <asyncio.runners.Runner object at 0x000002013538E780>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000020134983A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002013538E780>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000201349839C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000020134991800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000201348F5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002013538EC00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A7E0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002013549CD70>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002013538EC00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A7E0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A7E0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020137F186E0>
          └ <fastapi.applications.FastAPI object at 0x000002013549CD70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020137F21D00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000020137F1A...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020137F186E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020137F21E40>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000020137F19FA0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000020137F19FA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020137F21E40>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ArgumentError("reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not referen...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020137F8EF20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020137F19A00>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020137F8EF20>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000020137F1A810>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020137F19A00>
          └ <function wrap_app_handling_exceptions at 0x0000020136D1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F560>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F560>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000020137ED6A80>>
          └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F560>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000020136D1BA60>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F560>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000020137F21620>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F560>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000020137F98530>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000020137F8F6A0>
          └ <function wrap_app_handling_exceptions at 0x0000020136D1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137F8F7E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137F21DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000020137F8F6A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000020137F98530>
                     └ <function get_request_handler.<locals>.app at 0x0000020137F21580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002013207A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000020137F98DD0>}
                 │         └ <function add_start_data at 0x0000020137EA5620>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000020137F19490>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000020137F98DD0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x0000020137F61A90>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x0000020137EE4AF0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 20137ee2d50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x0000020137F61A90>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x0000020137AEEF20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x0000020137AE2E80>
    └ <Mapper at 0x20137ed7800; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x0000020137E372F0>
    │                      └ <Mapper at 0x20137ed7800; Brand>
    └ <function _configure_registries at 0x0000020137AEEB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x0000020137AEECA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4240, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x0000020137AE2D40>
    └ <Mapper at 0x20137ed7d70; Model>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2403, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x0000020137A26FC0>
    └ <Relationship at 0x20137ee6d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 579, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x0000020137ADD760>
    └ <Relationship at 0x20137ee6d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1643, in do_init
    self._generate_backref()
    │    └ <function RelationshipProperty._generate_backref at 0x0000020137ADE160>
    └ <Relationship at 0x20137ee6d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2129, in _generate_backref
    self._add_reverse_property(self.back_populates)
    │    │                     │    └ 'cars'
    │    │                     └ <Relationship at 0x20137ee6d50; brand>
    │    └ <function RelationshipProperty._add_reverse_property at 0x0000020137ADD580>
    └ <Relationship at 0x20137ee6d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1598, in _add_reverse_property
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.ArgumentError: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
2024-01-14T00:37:51.431495+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:38:32.426382+0300 ERROR  One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Model(models)]'. Original exception was: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000020135A46660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000020135A46700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 676
               │     └ 3
               └ <function _main at 0x0000020134838F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 676
           │    └ <function BaseProcess._bootstrap at 0x00000201347F3600>
           └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000201347F2B60>
    └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002013529ED20>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
    │    └ <function subprocess_started at 0x000002013537C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=556, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002013538ED50>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=556, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002013535B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002013538ED50>
           │       └ <function run at 0x0000020134826CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000201353CC240>
           │      └ <function Runner.run at 0x0000020134991F80>
           └ <asyncio.runners.Runner object at 0x000002013538E780>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000020134983A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002013538E780>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000201349839C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000020134991800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000201348F5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002013538EC00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE270>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002013549CD70>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002013538EC00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE270>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE270>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020137F186E0>
          └ <fastapi.applications.FastAPI object at 0x000002013549CD70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020137FB7920>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000201381AE...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020137F186E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020137FFB060>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000201381ADA60>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000201381ADA60>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020137FFB060>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggerin...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020137FFB2E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020137F19A00>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000020137F19A30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020137FFB2E0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000201381AE3C0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020137F19A00>
          └ <function wrap_app_handling_exceptions at 0x0000020136D1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB740>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB740>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000020137ED6A80>>
          └ <fastapi.routing.APIRouter object at 0x0000020137ED6A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB740>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000020136D1BA60>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB740>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000020137F21620>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB740>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000201381AE6C0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000020137FFB7E0>
          └ <function wrap_app_handling_exceptions at 0x0000020136D1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020137FFB920>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020137FFB240>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000020137FFB7E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000201381AE6C0>
                     └ <function get_request_handler.<locals>.app at 0x0000020137F21580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002013207A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000020137F98830>}
                 │         └ <function add_start_data at 0x0000020137EA5620>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000020137F19490>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000020137F98830>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x00000201381037D0>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x0000020137EE4AF0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 20137ee2d50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x00000201381037D0>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x0000020137AEEF20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x0000020137AE2E80>
    └ <Mapper at 0x20137ed7800; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x0000020137E372F0>
    │                      └ <Mapper at 0x20137ed7800; Brand>
    └ <function _configure_registries at 0x0000020137AEEB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x0000020137AEECA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4236, in _do_configure_registries
    raise e
          └ InvalidRequestError("One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggerin...

sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Model(models)]'. Original exception was: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
2024-01-14T00:38:40.288008+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:43:42.028662+0300 ERROR  Mapper 'Mapper[Brand(brands)]' has no property 'cars'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2505, in get_property
    return self._props[key]
           │    │      └ 'cars'
           │    └ {'id': <ColumnProperty at 0x1928a23e440; id>, 'name': <ColumnProperty at 0x1928a23db40; name>}
           └ <Mapper at 0x1928a2675f0; Brand>

KeyError: 'cars'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 760
               │     └ 3
               └ <function _main at 0x0000019286C18F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 760
           │    └ <function BaseProcess._bootstrap at 0x0000019286BD3600>
           └ <SpawnProcess name='SpawnProcess-2' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000019286BD2B60>
    └ <SpawnProcess name='SpawnProcess-2' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000019286BEF770>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26148 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26148 started>
    │    └ <function subprocess_started at 0x000001928775C0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=784, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001928776EE70>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=784, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001928773B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001928776EE70>
           │       └ <function run at 0x0000019286C06CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000192877AC440>
           │      └ <function Runner.run at 0x0000019286D71F80>
           └ <asyncio.runners.Runner object at 0x000001928776FDD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000019286D63A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001928776FDD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000019286D639C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000019286D71800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000019286CD5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001928A266D80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6B10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000019287878E60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001928A266D80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6B10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6B10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001928A2A5CD0>
          └ <fastapi.applications.FastAPI object at 0x0000019287878E60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001928A2B19E0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001928A2A6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001928A2A5CA0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001928A2A5CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001928A2B1B20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001928A2A6690>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001928A2A5CA0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001928A2A5CA0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001928A2A6690>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001928A2B1B20>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("Mapper 'Mapper[Brand(brands)]' has no property 'cars'.  If this property was indicated from other mapper...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001928A31EC00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001928A2A5C40>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001928A2A5CA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001928A31EC00>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001928A2A6B40>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001928A2A46E0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001928A2A5C40>
          └ <function wrap_app_handling_exceptions at 0x00000192890FA2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F240>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001928A2A46E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F240>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001928A2A46E0>>
          └ <fastapi.routing.APIRouter object at 0x000001928A2A46E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F240>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000192890FBA60>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F240>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001928A2B1300>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F240>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001928A328830>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001928A31F380>
          └ <function wrap_app_handling_exceptions at 0x00000192890FA2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001928A31F4C0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001928A2B1A80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001928A31F380>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001928A328830>
                     └ <function get_request_handler.<locals>.app at 0x000001928A2B1260>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000192843AA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001928A328140>}
                 │         └ <function add_start_data at 0x000001928A235620>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001928A2A5670>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001928A328140>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x000001928A2EE930>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x000001928A2749B0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 1928a272800>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x000001928A2EE930>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x0000019289E7EF20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x0000019289E72E80>
    └ <Mapper at 0x1928a2675f0; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x000001928A266DE0>
    │                      └ <Mapper at 0x1928a2675f0; Brand>
    └ <function _configure_registries at 0x0000019289E7EB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x0000019289E7ECA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4240, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x0000019289E72D40>
    └ <Mapper at 0x1928a267e00; Model>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2403, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x0000019289DB6FC0>
    └ <Relationship at 0x1928a276ad0; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 579, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x0000019289E6D760>
    └ <Relationship at 0x1928a276ad0; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1643, in do_init
    self._generate_backref()
    │    └ <function RelationshipProperty._generate_backref at 0x0000019289E6E160>
    └ <Relationship at 0x1928a276ad0; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2129, in _generate_backref
    self._add_reverse_property(self.back_populates)
    │    │                     │    └ 'cars'
    │    │                     └ <Relationship at 0x1928a276ad0; brand>
    │    └ <function RelationshipProperty._add_reverse_property at 0x0000019289E6D580>
    └ <Relationship at 0x1928a276ad0; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1574, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            │    │      │            └ 'cars'
            │    │      └ <function Mapper.get_property at 0x0000019289E73600>
            │    └ <Mapper at 0x1928a2675f0; Brand>
            └ <Relationship at 0x1928a276ad0; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2507, in get_property
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Brand(brands)]' has no property 'cars'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2024-01-14T00:43:42.087644+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:43:42.089685+0300 INFO  Response: 200
2024-01-14T00:43:42.220349+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:43:42.223450+0300 INFO  Response: 200
2024-01-14T00:43:51.765487+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:44:47.119144+0300 ERROR  reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000203DFC86660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000203DFC86700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 820
               │     └ 3
               └ <function _main at 0x00000203DEA78F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 820
           │    └ <function BaseProcess._bootstrap at 0x00000203DEA33600>
           └ <SpawnProcess name='SpawnProcess-3' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000203DEA32B60>
    └ <SpawnProcess name='SpawnProcess-3' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000203DEA4F770>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=26148 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=26148 started>
    │    └ <function subprocess_started at 0x00000203DF5BC0E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=26148 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=564, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000203DF5CF110>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=564, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000203DF59B6A0>
           │       │   └ <uvicorn.server.Server object at 0x00000203DF5CF110>
           │       └ <function run at 0x00000203DEA66CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000203DF60C440>
           │      └ <function Runner.run at 0x00000203DEBD1F80>
           └ <asyncio.runners.Runner object at 0x00000203DF5CEA20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000203DEBC3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000203DF5CEA20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000203DEBC39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000203DEBD1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000203DEB35440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000203DE727200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214EAE0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214E...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000203DF59C9B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000203DE727200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214EAE0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214E...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214EAE0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214E...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000203E214DC10>
          └ <fastapi.applications.FastAPI object at 0x00000203DF59C9B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000203E2171D00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000203E214E...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000203E214DCA0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000203E214DC10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000203E2171E40>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000203E214E630>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000203E214DCA0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000203E214DCA0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000203E214E630>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000203E2171E40>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ArgumentError("reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not referen...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000203E21DEF20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000203E214DD00>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000203E214DCA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000203E21DEF20>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000203DF5E0A10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000203E13017F0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000203E214DD00>
          └ <function wrap_app_handling_exceptions at 0x00000203E0F5A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF560>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000203E13017F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF560>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000203E13017F0>>
          └ <fastapi.routing.APIRouter object at 0x00000203E13017F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF560>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000203E0F5BA60>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF560>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000203E2171620>
          └ APIRoute(path='/items/add_start_data', name='add_start_data', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF560>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000203E21E87D0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000203E21DF6A0>
          └ <function wrap_app_handling_exceptions at 0x00000203E0F5A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000203E21DF7E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000203E2171DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000203E21DF6A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000203E21E87D0>
                     └ <function get_request_handler.<locals>.app at 0x00000203E2171580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000203DC21A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000203E21E8170>}
                 │         └ <function add_start_data at 0x00000203E20F5620>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000203E214D6D0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 22, in add_start_data
    if result := Items(db=db).start_data():
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000203E21E8170>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 9, in start_data
    brand1 = Brand(name="Toyota")
             └ <class 'app.shop.models.Brand'>

  File "<string>", line 4, in __init__
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\state.py", line 561, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
    │       │        │    │     │     └ {'name': 'Toyota'}
    │       │        │    │     └ ()
    │       │        │    └ <sqlalchemy.orm.state.InstanceState object at 0x00000203E21AE930>
    │       │        └ <member 'init' of 'InstanceEventsDispatch' objects>
    │       └ <sqlalchemy.event.base.InstanceEventsDispatch object at 0x00000203E2134AF0>
    └ <ClassManager of <class 'app.shop.models.Brand'> at 203e2132d50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\event\attr.py", line 499, in __call__
    fn(*args, **kw)
    │   │       └ {}
    │   └ (<sqlalchemy.orm.state.InstanceState object at 0x00000203E21AE930>, (), {'name': 'Toyota'})
    └ <function _event_on_init at 0x00000203E1D3EF20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4391, in _event_on_init
    instrumenting_mapper._check_configure()
    │                    └ <function Mapper._check_configure at 0x00000203E1D32E80>
    └ <Mapper at 0x203e21279b0; Brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x00000203E2126ED0>
    │                      └ <Mapper at 0x203e21279b0; Brand>
    └ <function _configure_registries at 0x00000203E1D3EB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x00000203E1D3ECA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4240, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x00000203E1D32D40>
    └ <Mapper at 0x203e2127ec0; Model>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2403, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x00000203E1C76FC0>
    └ <Relationship at 0x203e2136d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 579, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x00000203E1D2D760>
    └ <Relationship at 0x203e2136d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1643, in do_init
    self._generate_backref()
    │    └ <function RelationshipProperty._generate_backref at 0x00000203E1D2E160>
    └ <Relationship at 0x203e2136d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2129, in _generate_backref
    self._add_reverse_property(self.back_populates)
    │    │                     │    └ 'cars'
    │    │                     └ <Relationship at 0x203e2136d50; brand>
    │    └ <function RelationshipProperty._add_reverse_property at 0x00000203E1D2D580>
    └ <Relationship at 0x203e2136d50; brand>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1598, in _add_reverse_property
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.ArgumentError: reverse_property 'cars' on relationship Model.brand references relationship Brand.cars, which does not reference mapper Mapper[Model(models)]
2024-01-14T00:45:02.810760+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:45:18.970739+0300 INFO  Response: 404
2024-01-14T00:49:53.559074+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:50:04.898748+0300 INFO  Response: 404
2024-01-14T00:52:04.679601+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:52:04.683902+0300 INFO  Response: 200
2024-01-14T00:52:04.826228+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:52:04.830933+0300 INFO  Response: 200
2024-01-14T00:52:07.785083+0300 INFO  Request: GET http://127.0.0.1:8000/items/brands
2024-01-14T00:52:07.839699+0300 INFO  Response: 200
2024-01-14T00:52:51.226392+0300 INFO  Request: GET http://127.0.0.1:8000/items/add_start_data
2024-01-14T00:52:51.291904+0300 INFO  Response: 404
2024-01-14T00:52:54.962551+0300 INFO  Request: GET http://127.0.0.1:8000/items/brands
2024-01-14T00:52:54.969475+0300 INFO  Response: 200
2024-01-14T00:53:27.067418+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:53:27.072251+0300 INFO  Response: 200
2024-01-14T00:53:27.190818+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:53:27.197046+0300 INFO  Response: 200
2024-01-14T00:53:32.252856+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:53:32.308407+0300 INFO  Response: 200
2024-01-14T00:54:02.618922+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:54:02.677332+0300 INFO  Response: 200
2024-01-14T00:54:03.641220+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:54:03.650007+0300 INFO  Response: 200
2024-01-14T00:54:06.447370+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:55:42.263124+0300 INFO  Response: 200
2024-01-14T00:55:52.183516+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:56:02.276645+0300 INFO  Response: 200
2024-01-14T00:56:55.531932+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:56:55.535938+0300 INFO  Response: 200
2024-01-14T00:56:55.676474+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:56:55.685386+0300 INFO  Response: 200
2024-01-14T00:56:59.214759+0300 INFO  Request: GET http://127.0.0.1:8000/items/models
2024-01-14T00:57:02.621987+0300 INFO  Response: 200
2024-01-14T00:57:45.901302+0300 INFO  Request: GET http://127.0.0.1:8000/items/brands
2024-01-14T00:57:45.961686+0300 INFO  Response: 200
2024-01-14T00:57:56.433931+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T00:57:56.438955+0300 INFO  Response: 200
2024-01-14T00:57:56.585753+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T00:57:56.594064+0300 INFO  Response: 200
2024-01-14T00:57:59.562762+0300 INFO  Request: GET http://127.0.0.1:8000/items/brands
2024-01-14T00:57:59.613884+0300 INFO  Response: 200
2024-01-14T00:59:09.616928+0300 INFO  Request: GET http://127.0.0.1:8000/items/brands
2024-01-14T00:59:09.671717+0300 INFO  Response: 200
2024-01-14T01:00:12.114451+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:00:12.117326+0300 INFO  Response: 200
2024-01-14T01:00:12.230574+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:00:12.246364+0300 INFO  Response: 200
2024-01-14T01:00:14.815442+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:00:14.870796+0300 ERROR  'Car' object has no attribute 'name'
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000028F93632480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000028F93632520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 792
               │     └ 3
               └ <function _main at 0x0000028F913C8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 792
           │    └ <function BaseProcess._bootstrap at 0x0000028F9137F2E0>
           └ <SpawnProcess name='SpawnProcess-18' parent=27124 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000028F9137E840>
    └ <SpawnProcess name='SpawnProcess-18' parent=27124 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000028F9169B260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-18' parent=27124 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-18' parent=27124 started>
    │    └ <function subprocess_started at 0x0000028F91EEBEC0>
    └ <SpawnProcess name='SpawnProcess-18' parent=27124 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=188, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000028F90F9A8A0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=188, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000028F91EEB4C0>
           │       │   └ <uvicorn.server.Server object at 0x0000028F90F9A8A0>
           │       └ <function run at 0x0000028F913B6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000028F91F5C140>
           │      └ <function Runner.run at 0x0000028F9151DD00>
           └ <asyncio.runners.Runner object at 0x0000028F9149D250>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000028F915137E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028F9149D250>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028F91513740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028F9151D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028F914851C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000028F91F48F80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC6B0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000028F92030770>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000028F91F48F80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC6B0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC6B0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000028F94ABD0D0>
          └ <fastapi.applications.FastAPI object at 0x0000028F92030770>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028F94A9B420>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000028F94ABC...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000028F94ABD400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000028F94ABD0D0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000028F94A9A520>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000028F94AFFC50>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000028F94ABD400>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000028F94ABD400>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000028F94AFFC50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000028F94A9A520>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ AttributeError("'Car' object has no attribute 'name'")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000028F94A9A200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028F94ABD040>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000028F94ABD400>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000028F94A9A200>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000028F94ABD970>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000028F94A5DA00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028F94ABD040>
          └ <function wrap_app_handling_exceptions at 0x0000028F938D2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B199E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000028F94A5DA00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B199E0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028F94A5DA00>>
          └ <fastapi.routing.APIRouter object at 0x0000028F94A5DA00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B199E0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000028F938D3380>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B199E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000028F94A9B060>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B199E0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000028F94A5F980>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028F94B18FE0>
          └ <function wrap_app_handling_exceptions at 0x0000028F938D2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028F94B19580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000028F94A9A480>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028F94B18FE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000028F94A5F980>
                     └ <function get_request_handler.<locals>.app at 0x0000028F94A9B240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028F8EBBA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000028F94B38D40>}
                 │         └ <function get_models at 0x0000028F94A9AFC0>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000028F94A5F920>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_models
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000028F94B38D40>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 66, in get_cars
    return [CarSchema(name=x.name) for x in self.db.query(Car).all()]
            │                               │    │  │     └ <class 'app.shop.models.Car'>
            │                               │    │  └ <function Session.query at 0x0000028F94705620>
            │                               │    └ <sqlalchemy.orm.session.Session object at 0x0000028F94B38D40>
            │                               └ <app.shop.services.Items object at 0x0000028F94B38BC0>
            └ <class 'app.shop.schema.CarSchema'>

AttributeError: 'Car' object has no attribute 'name'
2024-01-14T01:00:59.052815+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:03:43.837022+0300 ERROR  'Car' object has no attribute 'name'
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000214663C6660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000214663C6700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 620
               │     └ 3
               └ <function _main at 0x00000214651B8F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 620
           │    └ <function BaseProcess._bootstrap at 0x00000214651776A0>
           └ <SpawnProcess name='SpawnProcess-1' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000021465176C00>
    └ <SpawnProcess name='SpawnProcess-1' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002146518FB00>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=11792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=11792 started>
    │    └ <function subprocess_started at 0x0000021465CFC0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000021465D0B320>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x0000021465CDB6A0>
           │       │   └ <uvicorn.server.Server object at 0x0000021465D0B320>
           │       └ <function run at 0x00000214651A6CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000021465D4C140>
           │      └ <function Runner.run at 0x0000021465311F80>
           └ <asyncio.runners.Runner object at 0x0000021465D0A510>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000021465303A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000021465D0A510>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000214653039C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000021465311800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000214652713A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000021465D22BA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9B20>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000214662D96A0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000021465D22BA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9B20>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9B20>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000214688D93A0>
          └ <fastapi.applications.FastAPI object at 0x00000214662D96A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000214688C6F20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000214688D9...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000214688D8CB0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000214688D93A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000214688C6E80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000214688D9BE0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000214688D8CB0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000214688D8CB0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000214688D9BE0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000214688C6E80>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ AttributeError("'Car' object has no attribute 'name'")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002146893CCC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000214688D9280>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000214688D8CB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002146893CCC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000214688D9B50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000021468881A60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000214688D9280>
          └ <function wrap_app_handling_exceptions at 0x000002146769A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D300>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000021468881A60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D300>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000021468881A60>>
          └ <fastapi.routing.APIRouter object at 0x0000021468881A60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D300>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002146769BA60>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D300>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000214688C6A20>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D300>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002146891F5F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002146893D440>
          └ <function wrap_app_handling_exceptions at 0x000002146769A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002146893D580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000214688C74C0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002146893D440>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002146891F5F0>
                     └ <function get_request_handler.<locals>.app at 0x00000214688C6C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002146298A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000002146891F050>}
                 │         └ <function get_models at 0x00000214688C7240>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000021468883530>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_models
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002146891F050>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 67, in get_cars
    return [CarSchema(name=name) for car, name in cars]
            └ <class 'app.shop.schema.CarSchema'>

AttributeError: 'Car' object has no attribute 'name'
2024-01-14T01:03:51.282791+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:04:02.078841+0300 ERROR  6 validation errors for CarSchema
id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
brand_id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
model_id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
power
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
created_at
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002C8A98AA660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002C8A98AA700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x000002C8A8698F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x000002C8A86576A0>
           └ <SpawnProcess name='SpawnProcess-2' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002C8A8656C00>
    └ <SpawnProcess name='SpawnProcess-2' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002C8A87C7BF0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=11792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=11792 started>
    │    └ <function subprocess_started at 0x000002C8A91DC0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=11792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=860, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002C8A91EB2F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=860, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002C8A91BB6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002C8A91EB2F0>
           │       └ <function run at 0x000002C8A8686CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002C8A922C140>
           │      └ <function Runner.run at 0x000002C8A87F1F80>
           └ <asyncio.runners.Runner object at 0x000002C8A91E9F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002C8A87E3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002C8A91E9F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002C8A87E39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002C8A87F1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002C8A8755440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002C8A91EAD50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D970>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002C8A8764B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002C8A91EAD50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D970>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D970>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002C8ABD1CCB0>
          └ <fastapi.applications.FastAPI object at 0x000002C8A8764B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002C8ABD06B60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002C8ABD1D...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002C8ABD1CBF0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002C8ABD1CCB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002C8ABD06FC0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002C8ABCC3A70>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002C8ABD1CBF0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002C8ABD1CBF0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002C8ABCC3A70>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002C8ABD06FC0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 6 validation errors for CarSchema
            id
              Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
                For...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002C8ABD84E00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002C8ABD1CD70>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002C8ABD1CBF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002C8ABD84E00>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002C8ABA5EED0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002C8ABCC1CD0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002C8ABD1CD70>
          └ <function wrap_app_handling_exceptions at 0x000002C8AAB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD85440>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002C8ABCC1CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD85440>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002C8ABCC1CD0>>
          └ <fastapi.routing.APIRouter object at 0x000002C8ABCC1CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD85440>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002C8AAB7BA60>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD85440>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002C8ABD06660>
          └ APIRoute(path='/items/cars', name='get_models', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD85440>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002C8ABD63680>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002C8ABD85580>
          └ <function wrap_app_handling_exceptions at 0x000002C8AAB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002C8ABD856C0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002C8ABD07420>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002C8ABD85580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002C8ABD63680>
                     └ <function get_request_handler.<locals>.app at 0x000002C8ABD06700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002C8A5E1A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000002C8ABDA0050>}
                 │         └ <function get_models at 0x000002C8ABD07380>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002C8ABCC2960>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_models
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002C8ABDA0050>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 67, in get_cars
    return [CarSchema(name=name) for car, name in cars]
            │                                     └ [(<app.shop.models.Car object at 0x000002C8ABDFEE70>, 'Toyota'), (<app.shop.models.Car object at 0x000002C8ABDFEEA0>, 'Toyota...
            └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ CarSchema()
    │                 │                      │               └ {'name': 'Toyota'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="CarSchema", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelF...
    └ CarSchema()

pydantic_core._pydantic_core.ValidationError: 6 validation errors for CarSchema
id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
brand_id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
model_id
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
power
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
created_at
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'name': 'Toyota'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T01:05:20.079756+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:05:34.992350+0300 ERROR  [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 322, in jsonable_encoder
    data = dict(obj)
                └ (<app.shop.models.Car object at 0x000002D601DDACF0>, 'Toyota')

TypeError: cannot convert dictionary update sequence element #0 to a sequence


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = vars(obj)
                └ (<app.shop.models.Car object at 0x000002D601DDACF0>, 'Toyota')

TypeError: vars() argument must have __dict__ attribute


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 688
               │     └ 3
               └ <function _main at 0x000002D67E668F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 688
           │    └ <function BaseProcess._bootstrap at 0x000002D67E6276A0>
           └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002D67E626C00>
    └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002D67E63FB30>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
    │    └ <function subprocess_started at 0x000002D67F1AC0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002D67F1BB2F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002D67F18B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002D67F1BB2F0>
           │       └ <function run at 0x000002D67E656CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002D67F1FC140>
           │      └ <function Runner.run at 0x000002D67E7C1F80>
           └ <asyncio.runners.Runner object at 0x000002D67F1BACF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002D67E7B3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002D67F1BACF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002D67E7B39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002D67E7C1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002D67E721440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D67F1B9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01670>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002D67F2C9190>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D67F1B9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01670>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01670>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D601CAB290>
          └ <fastapi.applications.FastAPI object at 0x000002D67F2C9190>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D601CE6C00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D601D01...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D601CAB290>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D601CE6B60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D601D01010>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002D601D01010>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D601CE6B60>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ValueError([TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D601D64E00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D601CAB2F0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D601D64E00>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002D601D016A0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D601CAB2F0>
          └ <function wrap_app_handling_exceptions at 0x000002D67FB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D65440>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D65440>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002D601A5F590>>
          └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D65440>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002D67FB7BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D65440>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002D601CE7F60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D65440>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002D601D3F410>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002D601D65580>
          └ <function wrap_app_handling_exceptions at 0x000002D67FB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D601D656C0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D601CE6520>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002D601D65580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002D601D3F410>
                     └ <function get_request_handler.<locals>.app at 0x000002D601CE7EC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x000002D67FB79EE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
           │                └ [(<app.shop.models.Car object at 0x000002D601DDACF0>, 'Toyota'), (<app.shop.models.Car object at 0x000002D601DDAD20>, 'Toyota...
           └ <function jsonable_encoder at 0x000002D67FB79A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 301, in jsonable_encoder
    jsonable_encoder(
    └ <function jsonable_encoder at 0x000002D67FB79A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 330, in jsonable_encoder
    raise ValueError(errors) from e
                     └ [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict...

ValueError: [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict__ attribute')]
2024-01-14T01:05:42.954175+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:06:51.504447+0300 ERROR  [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 322, in jsonable_encoder
    data = dict(obj)
                └ (<app.shop.models.Car object at 0x000002D603163E60>, 'Toyota')

TypeError: cannot convert dictionary update sequence element #0 to a sequence


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = vars(obj)
                └ (<app.shop.models.Car object at 0x000002D603163E60>, 'Toyota')

TypeError: vars() argument must have __dict__ attribute


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 688
               │     └ 3
               └ <function _main at 0x000002D67E668F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 688
           │    └ <function BaseProcess._bootstrap at 0x000002D67E6276A0>
           └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002D67E626C00>
    └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002D67E63FB30>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
    │    └ <function subprocess_started at 0x000002D67F1AC0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002D67F1BB2F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002D67F18B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002D67F1BB2F0>
           │       └ <function run at 0x000002D67E656CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002D67F1FC140>
           │      └ <function Runner.run at 0x000002D67E7C1F80>
           └ <asyncio.runners.Runner object at 0x000002D67F1BACF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002D67E7B3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002D67F1BACF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002D67E7B39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002D67E7C1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002D67E721440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D67F1B9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D6031627B0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D603162...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002D67F2C9190>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D67F1B9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D6031627B0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D603162...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D6031627B0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D603162...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D601CAB290>
          └ <fastapi.applications.FastAPI object at 0x000002D67F2C9190>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D6031C9B20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D603162...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D601CAB290>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D6031C99E0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D603161F70>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002D603161F70>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D6031C99E0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ValueError([TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D6031C9EE0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D601CAB2F0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002D601CAAFF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D6031C9EE0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002D603162930>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D601CAB2F0>
          └ <function wrap_app_handling_exceptions at 0x000002D67FB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA480>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002D601A5F590>>
          └ <fastapi.routing.APIRouter object at 0x000002D601A5F590>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA480>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002D67FB7BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA480>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002D601CE7F60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA480>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002D603162C30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002D6031CA520>
          └ <function wrap_app_handling_exceptions at 0x000002D67FB7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D6031CA660>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D6031C9BC0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002D6031CA520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002D603162C30>
                     └ <function get_request_handler.<locals>.app at 0x000002D601CE7EC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x000002D67FB79EE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 180, in serialize_response
    return jsonable_encoder(response_content)
           │                └ [(<app.shop.models.Car object at 0x000002D603163E60>, 'Toyota'), (<app.shop.models.Car object at 0x000002D603163EC0>, 'Toyota...
           └ <function jsonable_encoder at 0x000002D67FB79A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 301, in jsonable_encoder
    jsonable_encoder(
    └ <function jsonable_encoder at 0x000002D67FB79A80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\encoders.py", line 330, in jsonable_encoder
    raise ValueError(errors) from e
                     └ [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict...

ValueError: [TypeError('cannot convert dictionary update sequence element #0 to a sequence'), TypeError('vars() argument must have __dict__ attribute')]
2024-01-14T01:07:14.860376+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:07:26.827228+0300 INFO  Response: 200
2024-01-14T01:08:24.776241+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:08:30.242184+0300 INFO  Response: 200
2024-01-14T01:08:43.361537+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:09:11.319417+0300 INFO  Response: 200
2024-01-14T01:09:22.780719+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:09:24.605702+0300 INFO  Response: 200
2024-01-14T01:10:36.474897+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:10:36.548238+0300 ERROR  Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002B0CA3A6660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002B0CA3A6700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 760
               │     └ 3
               └ <function _main at 0x000002B0C9198F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 760
           │    └ <function BaseProcess._bootstrap at 0x000002B0C9157600>
           └ <SpawnProcess name='SpawnProcess-9' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002B0C9156B60>
    └ <SpawnProcess name='SpawnProcess-9' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002B0C916F470>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=26192 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=26192 started>
    │    └ <function subprocess_started at 0x000002B0C9CDC0E0>
    └ <SpawnProcess name='SpawnProcess-9' parent=26192 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=836, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002B0C9CEEDE0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=836, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002B0C9CBB6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002B0C9CEEDE0>
           │       └ <function run at 0x000002B0C9186CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002B0C9D2C240>
           │      └ <function Runner.run at 0x000002B0C92F1F80>
           └ <asyncio.runners.Runner object at 0x000002B0C9CEE570>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002B0C92E3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002B0C9CEE570>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002B0C92E39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002B0C92F1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002B0C9255440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002B0C6D3EFC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC8507A0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC850...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002B0C9CECB60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002B0C6D3EFC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC8507A0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC850...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC8507A0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC850...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002B0CC7F33E0>
          └ <fastapi.applications.FastAPI object at 0x000002B0C9CECB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002B0C9CF5940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002B0CC850...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002B0CC7F3560>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002B0CC7F33E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002B0CC836CA0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002B0CC850DA0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002B0CC7F3560>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002B0CC7F3560>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002B0CC850DA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002B0CC836CA0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002B0CC8B4D60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002B0CC7F34D0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002B0CC7F3560>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002B0CC8B4D60>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002B0CC8508C0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002B0CB7FACC0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002B0CC7F34D0>
          └ <function wrap_app_handling_exceptions at 0x000002B0CB67A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B53A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002B0CB7FACC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B53A0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002B0CB7FACC0>>
          └ <fastapi.routing.APIRouter object at 0x000002B0CB7FACC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B53A0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002B0CB67BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B53A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002B0CC837F60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B53A0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002B0CC88F4A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002B0CC8B54E0>
          └ <function wrap_app_handling_exceptions at 0x000002B0CB67A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002B0CC8B5620>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002B0CC836700>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002B0CC8B54E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002B0CC88F4A0>
                     └ <function get_request_handler.<locals>.app at 0x000002B0CC837E20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002B0C696A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000002B0CC88EE40>}
                 │         └ <function get_cars at 0x000002B0CC8372E0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002B0CC851520>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002B0CC88EE40>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 66, in get_cars
    cars = self.db.query(Car, Brand.name, Model.name).join(Brand).join(Model).all()
           │    │  │     │    │     │     │     │          │           └ <class 'app.shop.models.Model'>
           │    │  │     │    │     │     │     │          └ <class 'app.shop.models.Brand'>
           │    │  │     │    │     │     │     └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000002B0CC8347C0>
           │    │  │     │    │     │     └ <class 'app.shop.models.Model'>
           │    │  │     │    │     └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000002B0CC7E76A0>
           │    │  │     │    └ <class 'app.shop.models.Brand'>
           │    │  │     └ <class 'app.shop.models.Car'>
           │    │  └ <function Session.query at 0x000002B0CC4CD6C0>
           │    └ <sqlalchemy.orm.session.Session object at 0x000002B0CC88EE40>
           └ <app.shop.services.Items object at 0x000002B0CC88FE90>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2693, in all
    return self._iter().all()  # type: ignore
           │    └ <function Query._iter at 0x000002B0CC444900>
           └ <sqlalchemy.orm.query.Query object at 0x000002B0CC88FEF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
            │                  │    │      │      │    │       └ <function Session.execute at 0x000002B0CC4CC540>
            │                  │    │      │      │    └ <sqlalchemy.orm.session.Session object at 0x000002B0CC88EE40>
            │                  │    │      │      └ <sqlalchemy.orm.query.Query object at 0x000002B0CC88FEF0>
            │                  │    │      └ ~_T
            │                  │    └ <class 'sqlalchemy.engine.result.Result'>
            │                  └ ~_T
            └ typing.Union
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000002B0CC4CC220>
           └ <sqlalchemy.orm.session.Session object at 0x000002B0CC88EE40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x000002B0CB53D8A0>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000002B0CC1772E0>
             └ <sqlalchemy.engine.base.Connection object at 0x000002B0CC8DAD80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002B0CC177600>
           └ <sqlalchemy.engine.base.Connection object at 0x000002B0CC8DAD80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x000002B0CBEF4180>
                                                └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 705, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x000002B0CBEE3100>
                   └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 317, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': CacheKey(key=('0', <class 'sqlalchemy.sql.selectable.Select'>, '_raw_columns', ((Table('cars', MetaData(), Colu...
           │       │                  │        └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
           │       │                  └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002B0CC5E4650>
           │       └ <class 'sqlalchemy.dialects.postgresql.base.PGCompiler'>
           └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002B0CC5E4650>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1427, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
    │        │        │     └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002B0CC5E4650>
    │        │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
    │        └ <function Compiled.__init__ at 0x000002B0CC0B6020>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
    │    │        │    └ <function Compiled.process at 0x000002B0CC0B63E0>
    │    │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
           │   └ <function Visitable._generate_compiler_dispatch.<locals>._compiler_dispatch at 0x000002B0CC04B1A0>
           └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
           └ <bound method SQLCompiler.visit_select of <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4609, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    │           └ <bound method CompileState.create_for_statement of <class 'sqlalchemy.sql.base.CompileState'>>
                    └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           │     │                    │          │           └ {'within_columns_clause': False}
           │     │                    │          └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000002B0CC8DB9E0>
           │     │                    └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
           │     └ <classmethod(<function ORMSelectCompileState.create_for_statement at 0x000002B0CB53ECA0>)>
           └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1162, in create_for_statement
    self._setup_for_generate()
    │    └ <function ORMSelectCompileState._setup_for_generate at 0x000002B0CB53EDE0>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002B0CC899CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1197, in _setup_for_generate
    self._join(query._setup_joins, self._entities)
    │    │     │     │             │    └ [<sqlalchemy.orm.context._MapperEntity object at 0x000002B0CC89DCB0>, <sqlalchemy.orm.context._ORMColumnEntity object at 0x00...
    │    │     │     │             └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002B0CC899CD0>
    │    │     │     └ ((Table('brands', MetaData(), Column('id', Integer(), table=<brands>, primary_key=True, nullable=False), Column('name', Strin...
    │    │     └ <sqlalchemy.sql.selectable.Select object at 0x000002B0CC8D9490>
    │    └ <function ORMSelectCompileState._join at 0x000002B0CB53F9C0>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002B0CC899CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1834, in _join
    self._join_left_to_right(
    │    └ <function ORMSelectCompileState._join_left_to_right at 0x000002B0CB53FA60>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002B0CC899CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1869, in _join_left_to_right
    ) = self._join_determine_implicit_left_side(
        │    └ <function ORMSelectCompileState._join_determine_implicit_left_side at 0x000002B0CB53FB00>
        └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002B0CC899CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 2024, in _join_determine_implicit_left_side
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.InvalidRequestError: Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
2024-01-14T01:11:27.964404+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:11:32.259722+0300 INFO  Response: 200
2024-01-14T01:12:03.710135+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:12:03.772992+0300 ERROR  2 validation errors for CarSchema
created_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000016F88476660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000016F88476700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 784
               │     └ 3
               └ <function _main at 0x0000016F87268F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 784
           │    └ <function BaseProcess._bootstrap at 0x0000016F87227600>
           └ <SpawnProcess name='SpawnProcess-2' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000016F87226B60>
    └ <SpawnProcess name='SpawnProcess-2' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000016F87CCF470>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=22160 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=22160 started>
    │    └ <function subprocess_started at 0x0000016F87DAC0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=820, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000016F87DBEE40>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=820, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000016F87D8B6A0>
           │       │   └ <uvicorn.server.Server object at 0x0000016F87DBEE40>
           │       └ <function run at 0x0000016F87256CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000016F87DFC240>
           │      └ <function Runner.run at 0x0000016F873C1F80>
           └ <asyncio.runners.Runner object at 0x0000016F87DBDD90>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000016F873B3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000016F87DBDD90>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000016F873B39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000016F873C1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000016F87325440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016F87DD54C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931700>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000016F8986BFB0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016F87DD54C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931700>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931700>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000016F8A8D6E70>
          └ <fastapi.applications.FastAPI object at 0x0000016F8986BFB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000016F8A916E80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000016F8A931...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000016F8A8D6F90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000016F8A8D6E70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000016F8A916B60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000016F8A930F80>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000016F8A8D6F90>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000016F8A8D6F90>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000016F8A930F80>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000016F8A916B60>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 2 validation errors for CarSchema
            created_at
              Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_n...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000016F8A994D60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000016F8A8D6CF0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000016F8A8D6F90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000016F8A994D60>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000016F8A931730>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000016F8A8D5AF0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000016F8A8D6CF0>
          └ <function wrap_app_handling_exceptions at 0x0000016F8974A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A9953A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000016F8A8D5AF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A9953A0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000016F8A8D5AF0>>
          └ <fastapi.routing.APIRouter object at 0x0000016F8A8D5AF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A9953A0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000016F8974BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A9953A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000016F8A934CC0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A9953A0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000016F8A973410>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000016F8A9954E0>
          └ <function wrap_app_handling_exceptions at 0x0000016F8974A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000016F8A995620>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000016F8A9167A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000016F8A9954E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000016F8A973410>
                     └ <function get_request_handler.<locals>.app at 0x0000016F8A934C20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000016F849FA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000016F8A972CF0>}
                 │         └ <function get_cars at 0x0000016F8A9172E0>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000016F8A9312E0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000016F8A972CF0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 74, in get_cars
    CarSchema(
    └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ CarSchema()
    │                 │                      │               └ {'power': 115.0, 'brand_name': 'Toyota', 'model_name': 'Corolla'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="CarSchema", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelF...
    └ CarSchema()

pydantic_core._pydantic_core.ValidationError: 2 validation errors for CarSchema
created_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T01:12:26.051283+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:12:26.112328+0300 ERROR  2 validation errors for CarSchema
created_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001C193E86660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001C193E86700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 760
               │     └ 3
               └ <function _main at 0x000001C192C78F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 760
           │    └ <function BaseProcess._bootstrap at 0x000001C192C37600>
           └ <SpawnProcess name='SpawnProcess-3' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001C192C36B60>
    └ <SpawnProcess name='SpawnProcess-3' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001C192C4F470>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=22160 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=22160 started>
    │    └ <function subprocess_started at 0x000001C1937BC0E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=22160 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=772, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001C1937CEA50>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=772, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001C19379B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001C1937CEA50>
           │       └ <function run at 0x000001C192C66CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001C19380C240>
           │      └ <function Runner.run at 0x000001C192DD1F80>
           └ <asyncio.runners.Runner object at 0x000001C1937CDD90>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001C192DC3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001C1937CDD90>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001C192DC39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001C192DD1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001C192D35440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C192927200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300530>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001C1937CED20>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C192927200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300530>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300530>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C1962A6E70>
          └ <fastapi.applications.FastAPI object at 0x000001C1937CED20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001C1962E6E80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C196300...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001C1962A6FF0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C1962A6E70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001C1962E6B60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001C196300F20>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001C1962A6FF0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001C1962A6FF0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001C196300F20>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001C1962E6B60>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 2 validation errors for CarSchema
            created_at
              Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_n...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001C196364D60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C1962A70E0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001C1962A6FF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001C196364D60>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001C1963006B0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001C1962A5A60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C1962A70E0>
          └ <function wrap_app_handling_exceptions at 0x000001C19515A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C1963653A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001C1962A5A60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C1963653A0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001C1962A5A60>>
          └ <fastapi.routing.APIRouter object at 0x000001C1962A5A60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C1963653A0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001C19515BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C1963653A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001C196304CC0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C1963653A0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001C19633F4D0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001C1963654E0>
          └ <function wrap_app_handling_exceptions at 0x000001C19515A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C196365620>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C1962E67A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001C1963654E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001C19633F4D0>
                     └ <function get_request_handler.<locals>.app at 0x000001C196304C20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001C19041A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001C19633ED20>}
                 │         └ <function get_cars at 0x000001C1962E72E0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001C196301400>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001C19633ED20>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 74, in get_cars
    CarSchema(
    └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ CarSchema()
    │                 │                      │               └ {'power': 115.0, 'brand_name': 'Toyota', 'model_name': 'Corolla'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="CarSchema", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelF...
    └ CarSchema()

pydantic_core._pydantic_core.ValidationError: 2 validation errors for CarSchema
created_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
updated_at
  Field required [type=missing, input_value={'power': 115.0, 'brand_n...'model_name': 'Corolla'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T01:13:02.694674+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:13:12.589306+0300 INFO  Response: 200
2024-01-14T01:14:03.008259+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:14:03.017424+0300 INFO  Response: 200
2024-01-14T01:15:17.896740+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:15:17.974004+0300 INFO  Response: 200
2024-01-14T01:16:43.845694+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:16:43.915009+0300 INFO  Response: 200
2024-01-14T01:17:32.114010+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:17:32.178059+0300 ERROR  (psycopg2.errors.GroupingError) column "brands.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...s_created_at, cars.updated_at AS cars_updated_at, brands.nam...
                                                             ^

[SQL: SELECT cars.id AS cars_id, cars.brand_id AS cars_brand_id, cars.model_id AS cars_model_id, cars.power AS cars_power, cars.created_at AS cars_created_at, cars.updated_at AS cars_updated_at, brands.name AS brands_name, models.name AS models_name 
FROM cars JOIN brands ON brands.id = cars.brand_id JOIN models ON brands.id = models.brand_id GROUP BY cars.id]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001B3402EACA0>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001B33FB671A0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT cars.id AS cars_id, cars.brand_id AS cars_brand_id, cars.model_id AS cars_model_id, cars.power AS cars_power, cars.cr...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001B3409FCBA0; closed: -1>

psycopg2.errors.GroupingError: column "brands.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...s_created_at, cars.updated_at AS cars_updated_at, brands.nam...
                                                             ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x000001B33D318C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x000001B33D2CF2E0>
           └ <SpawnProcess name='SpawnProcess-4' parent=6888 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001B33D2CE840>
    └ <SpawnProcess name='SpawnProcess-4' parent=6888 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001B33D2F3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=6888 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=6888 started>
    │    └ <function subprocess_started at 0x000001B33DE3BEC0>
    └ <SpawnProcess name='SpawnProcess-4' parent=6888 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=676, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001B33DE6A9F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=676, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001B33DE3B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001B33DE6A9F0>
           │       └ <function run at 0x000001B33D306980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001B33DEAC140>
           │      └ <function Runner.run at 0x000001B33D46DD00>
           └ <asyncio.runners.Runner object at 0x000001B33DE6A630>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001B33D4637E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001B33DE6A630>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001B33D463740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001B33D46D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001B33D3D51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B33DE68950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D8E0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001B33DE81250>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B33DE68950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D8E0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D8E0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B34099D130>
          └ <fastapi.applications.FastAPI object at 0x000001B33DE81250>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001B34097EFC0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B34099D...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001B34099D520>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B34099D130>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001B34097F2E0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001B34099D9A0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001B34099D520>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001B34099D520>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001B34099D9A0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001B34097F2E0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ProgrammingError('(psycopg2.errors.GroupingError) column "brands.name" must appear in the GROUP BY clause or be used in an ag...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001B3409F8CC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B34099D0A0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001B34099D520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001B3409F8CC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001B34099C620>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001B340939940>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B34099D0A0>
          └ <function wrap_app_handling_exceptions at 0x000001B33F822520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9300>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001B340939940>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9300>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001B340939940>>
          └ <fastapi.routing.APIRouter object at 0x000001B340939940>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9300>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001B33F823380>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9300>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001B34097F1A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9300>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001B3409DF680>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001B3409F9440>
          └ <function wrap_app_handling_exceptions at 0x000001B33F822520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B3409F9580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B34097F380>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001B3409F9440>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001B3409DF680>
                     └ <function get_request_handler.<locals>.app at 0x000001B34097F240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001B33AAEA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001B3409DEF00>}
                 │         └ <function get_cars at 0x000001B34097ED40>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001B34093ACF0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001B3409DEF00>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 72, in get_cars
    .all()

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2693, in all
    return self._iter().all()  # type: ignore
           │    └ <function Query._iter at 0x000001B340558680>
           └ <sqlalchemy.orm.query.Query object at 0x000001B340A21E50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
            │                  │    │      │      │    │       └ <function Session.execute at 0x000001B3405E42C0>
            │                  │    │      │      │    └ <sqlalchemy.orm.session.Session object at 0x000001B3409DEF00>
            │                  │    │      │      └ <sqlalchemy.orm.query.Query object at 0x000001B340A21E50>
            │                  │    │      └ ~_T
            │                  │    └ <class 'sqlalchemy.engine.result.Result'>
            │                  └ ~_T
            └ typing.Union
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001B3405D3F60>
           └ <sqlalchemy.orm.session.Session object at 0x000001B3409DEF00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x000001B340461620>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000001B34021AB60>
             └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x000001B340A21400>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001B34021AE80>
           └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001B34021B060>
          └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001B34021B100>
           └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001B34021B380>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ GroupingError('column "brands.name" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: ...s_crea...
          │                    │              └ (<class 'psycopg2.errors.GroupingError'>, GroupingError('column "brands.name" must appear in the GROUP BY clause or be used i...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ ProgrammingError('(psycopg2.errors.GroupingError) column "brands.name" must appear in the GROUP BY clause or be used in an ag...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001B3402EACA0>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001B33FB671A0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001B340A22E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {}
    │      │       └ 'SELECT cars.id AS cars_id, cars.brand_id AS cars_brand_id, cars.model_id AS cars_model_id, cars.power AS cars_power, cars.cr...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001B3409FCBA0; closed: -1>

sqlalchemy.exc.ProgrammingError: (psycopg2.errors.GroupingError) column "brands.name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...s_created_at, cars.updated_at AS cars_updated_at, brands.nam...
                                                             ^

[SQL: SELECT cars.id AS cars_id, cars.brand_id AS cars_brand_id, cars.model_id AS cars_model_id, cars.power AS cars_power, cars.created_at AS cars_created_at, cars.updated_at AS cars_updated_at, brands.name AS brands_name, models.name AS models_name 
FROM cars JOIN brands ON brands.id = cars.brand_id JOIN models ON brands.id = models.brand_id GROUP BY cars.id]
(Background on this error at: https://sqlalche.me/e/20/f405)
2024-01-14T01:18:17.223110+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:18:17.283887+0300 INFO  Response: 200
2024-01-14T01:22:41.533751+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:22:41.594472+0300 ERROR  'int' object has no attribute 'power'
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000024327632480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000024327632520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 772
               │     └ 3
               └ <function _main at 0x00000243253C8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 772
           │    └ <function BaseProcess._bootstrap at 0x000002432537F2E0>
           └ <SpawnProcess name='SpawnProcess-2' parent=24072 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002432537E840>
    └ <SpawnProcess name='SpawnProcess-2' parent=24072 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000243253A3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=24072 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=24072 started>
    │    └ <function subprocess_started at 0x0000024325EEBEC0>
    └ <SpawnProcess name='SpawnProcess-2' parent=24072 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=192, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000024325F1AB70>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=192, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000024325EEB4C0>
           │       │   └ <uvicorn.server.Server object at 0x0000024325F1AB70>
           │       └ <function run at 0x00000243253B6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000024325F5C140>
           │      └ <function Runner.run at 0x000002432551DD00>
           └ <asyncio.runners.Runner object at 0x0000024325F1A690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000243255137E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000024325F1A690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000024325513740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002432551D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000243254851C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002432886B0B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29AC0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002432602C7A0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002432886B0B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29AC0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29AC0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000024328B29400>
          └ <fastapi.applications.FastAPI object at 0x000002432602C7A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000024328B0E660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024328B29...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000024328B297F0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000024328B29400>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000024328B0F100>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000024328B29B50>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000024328B297F0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000024328B297F0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000024328B29B50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000024328B0F100>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ AttributeError("'int' object has no attribute 'power'")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000024328B88D60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000024328B297C0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000024328B297F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000024328B88D60>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000024328584B30>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000024328ACCE30>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000024328B297C0>
          └ <function wrap_app_handling_exceptions at 0x00000243278D2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B893A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000024328ACCE30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B893A0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000024328ACCE30>>
          └ <fastapi.routing.APIRouter object at 0x0000024328ACCE30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B893A0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000243278D3380>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B893A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000024328B0EFC0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B893A0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000024328B6B6E0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000024328B894E0>
          └ <function wrap_app_handling_exceptions at 0x00000243278D2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000024328B89620>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000024328B0F380>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000024328B894E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000024328B6B6E0>
                     └ <function get_request_handler.<locals>.app at 0x0000024328B0F240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000024322C4A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000024328B6AF30>}
                 │         └ <function get_cars at 0x0000024328B0EDE0>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000024328ACF1A0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000024328B6AF30>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 76, in get_cars
    power=car.power,

AttributeError: 'int' object has no attribute 'power'
2024-01-14T01:23:58.654726+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:24:08.507340+0300 ERROR  'float' object has no attribute 'power'
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000257782FA660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000257782FA700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 756
               │     └ 3
               └ <function _main at 0x00000257770E8EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 756
           │    └ <function BaseProcess._bootstrap at 0x00000257770A76A0>
           └ <SpawnProcess name='SpawnProcess-1' parent=3728 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000257770A6C00>
    └ <SpawnProcess name='SpawnProcess-1' parent=3728 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000257770BFB60>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=3728 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=3728 started>
    │    └ <function subprocess_started at 0x0000025777C2C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=3728 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=764, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002577732B260>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=764, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000025777C0B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002577732B260>
           │       └ <function run at 0x00000257770D6C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000025777C7C140>
           │      └ <function Runner.run at 0x0000025777241EE0>
           └ <asyncio.runners.Runner object at 0x0000025777C3A6F0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000257772339C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000025777C3A6F0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000025777233920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000025777241760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000257771A53A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000025777C50350>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829B20>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000025777C0C9B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000025777C50350>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829B20>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829B20>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002577A829730>
          └ <fastapi.applications.FastAPI object at 0x0000025777C0C9B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002577A80A2A0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002577A829...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002577A829760>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002577A829730>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002577A80B420>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002577A829B50>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002577A829760>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002577A829760>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002577A829B50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002577A80B420>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ AttributeError("'float' object has no attribute 'power'")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002577A888F40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002577A829790>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002577A829760>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002577A888F40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002577A828FE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002577A7D1D00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002577A829790>
          └ <function wrap_app_handling_exceptions at 0x00000257795F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002577A7D1D00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889580>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002577A7D1D00>>
          └ <fastapi.routing.APIRouter object at 0x000002577A7D1D00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889580>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000257795F3560>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889580>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002577A80B1A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889580>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002577A86B7A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002577A8896C0>
          └ <function wrap_app_handling_exceptions at 0x00000257795F2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002577A889800>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002577A80B2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002577A8896C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002577A86B7A0>
                     └ <function get_request_handler.<locals>.app at 0x000002577A80B060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002577491A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000002577A8AC140>}
                 │         └ <function get_cars at 0x000002577A80AF20>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002577A7D2F60>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002577A8AC140>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 76, in get_cars
    power=car.power,

AttributeError: 'float' object has no attribute 'power'
2024-01-14T01:24:41.510118+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:24:44.931931+0300 INFO  Response: 200
2024-01-14T01:25:55.782389+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:25:55.835500+0300 ERROR  Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000017BCB7AA660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000017BCB7AA700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 728
               │     └ 3
               └ <function _main at 0x0000017BCA598EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 728
           │    └ <function BaseProcess._bootstrap at 0x0000017BCA5576A0>
           └ <SpawnProcess name='SpawnProcess-2' parent=29268 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000017BCA556C00>
    └ <SpawnProcess name='SpawnProcess-2' parent=29268 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000017BCA56FB30>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=29268 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=29268 started>
    │    └ <function subprocess_started at 0x0000017BCB0DC0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=29268 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=1004, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000017BCB0EB380>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=1004, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000017BCB0BB6A0>
           │       │   └ <uvicorn.server.Server object at 0x0000017BCB0EB380>
           │       └ <function run at 0x0000017BCA586C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000017BCB12C140>
           │      └ <function Runner.run at 0x0000017BCAEF1EE0>
           └ <asyncio.runners.Runner object at 0x0000017BCB0EAE10>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000017BCAEE39C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017BCB0EAE10>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017BCAEE3920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017BCAEF1760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017BCAE553A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000017BCB0E9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55AF0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000017BCAF049B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000017BCB0E9DC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55AF0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55AF0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000017BCDC553A0>
          └ <fastapi.applications.FastAPI object at 0x0000017BCAF049B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017BCDC920C0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017BCDC55...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000017BCDC55040>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000017BCDC553A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000017BCDC93420>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000017BCDC55B80>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000017BCDC55040>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000017BCDC55040>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000017BCDC55B80>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000017BCDC93420>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000017BCDD0CF40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000017BCDC55310>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000017BCDC55040>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000017BCDD0CF40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000017BCDC55B20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000017BCDC45B50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000017BCDC55310>
          └ <function wrap_app_handling_exceptions at 0x0000017BCCAA2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000017BCDC45B50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D580>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000017BCDC45B50>>
          └ <fastapi.routing.APIRouter object at 0x0000017BCDC45B50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D580>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000017BCCAA3560>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D580>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000017BCDC931A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D580>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000017BCDCEB7D0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017BCDD0D6C0>
          └ <function wrap_app_handling_exceptions at 0x0000017BCCAA2700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017BCDD0D800>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000017BCDC932E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017BCDD0D6C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000017BCDCEB7D0>
                     └ <function get_request_handler.<locals>.app at 0x0000017BCDC93060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017BC7D5A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000017BCDD2C110>}
                 │         └ <function get_cars at 0x0000017BCDC92F20>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000017BCDC47B90>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000017BCDD2C110>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 72, in get_cars
    .all()

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2693, in all
    return self._iter().all()  # type: ignore
           │    └ <function Query._iter at 0x0000017BCD86C860>
           └ <sqlalchemy.orm.query.Query object at 0x0000017BCDD2C680>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
            │                  │    │      │      │    │       └ <function Session.execute at 0x0000017BCD8F84A0>
            │                  │    │      │      │    └ <sqlalchemy.orm.session.Session object at 0x0000017BCDD2C110>
            │                  │    │      │      └ <sqlalchemy.orm.query.Query object at 0x0000017BCDD2C680>
            │                  │    │      └ ~_T
            │                  │    └ <class 'sqlalchemy.engine.result.Result'>
            │                  └ ~_T
            └ typing.Union
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x0000017BCD8F8180>
           └ <sqlalchemy.orm.session.Session object at 0x0000017BCDD2C110>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x0000017BCD775800>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x0000017BCD52AD40>
             └ <sqlalchemy.engine.base.Connection object at 0x0000017BCDD2CA10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000017BCD52B060>
           └ <sqlalchemy.engine.base.Connection object at 0x0000017BCDD2CA10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x0000017BCD29BBA0>
                                                └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 705, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x0000017BCD29AB60>
                   └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 317, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': CacheKey(key=('0', <class 'sqlalchemy.sql.selectable.Select'>, '_raw_columns', (('1', <class 'sqlalchemy.sql.an...
           │       │                  │        └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
           │       │                  └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017BCD9E7650>
           │       └ <class 'sqlalchemy.dialects.postgresql.base.PGCompiler'>
           └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017BCD9E7650>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1427, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
    │        │        │     └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017BCD9E7650>
    │        │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
    │        └ <function Compiled.__init__ at 0x0000017BCD479A80>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
    │    │        │    └ <function Compiled.process at 0x0000017BCD479E40>
    │    │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
           │   └ <function Visitable._generate_compiler_dispatch.<locals>._compiler_dispatch at 0x0000017BCD3FAC00>
           └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
           └ <bound method SQLCompiler.visit_select of <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4609, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    │           └ <bound method CompileState.create_for_statement of <class 'sqlalchemy.sql.base.CompileState'>>
                    └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           │     │                    │          │           └ {'within_columns_clause': False}
           │     │                    │          └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x0000017BCDD2D4F0>
           │     │                    └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
           │     └ <classmethod(<function ORMSelectCompileState.create_for_statement at 0x0000017BCD776C00>)>
           └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1162, in create_for_statement
    self._setup_for_generate()
    │    └ <function ORMSelectCompileState._setup_for_generate at 0x0000017BCD776D40>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x0000017BCDCF51F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1197, in _setup_for_generate
    self._join(query._setup_joins, self._entities)
    │    │     │     │             │    └ [<sqlalchemy.orm.context._ORMColumnEntity object at 0x0000017BCDD3D940>, <sqlalchemy.orm.context._ORMColumnEntity object at 0...
    │    │     │     │             └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x0000017BCDCF51F0>
    │    │     │     └ ((Table('brands', MetaData(), Column('id', Integer(), table=<brands>, primary_key=True, nullable=False), Column('name', Strin...
    │    │     └ <sqlalchemy.sql.selectable.Select object at 0x0000017BCDD2C6E0>
    │    └ <function ORMSelectCompileState._join at 0x0000017BCD777920>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x0000017BCDCF51F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1834, in _join
    self._join_left_to_right(
    │    └ <function ORMSelectCompileState._join_left_to_right at 0x0000017BCD7779C0>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x0000017BCDCF51F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1869, in _join_left_to_right
    ) = self._join_determine_implicit_left_side(
        │    └ <function ORMSelectCompileState._join_determine_implicit_left_side at 0x0000017BCD777A60>
        └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x0000017BCDCF51F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 2024, in _join_determine_implicit_left_side
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.InvalidRequestError: Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
2024-01-14T01:29:21.805680+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:29:41.203616+0300 ERROR  Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000012759B56660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000012759B56700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 756
               │     └ 3
               └ <function _main at 0x0000012758948F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 756
           │    └ <function BaseProcess._bootstrap at 0x0000012758907740>
           └ <SpawnProcess name='SpawnProcess-1' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000012758906CA0>
    └ <SpawnProcess name='SpawnProcess-1' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001275891BB90>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=24560 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=24560 started>
    │    └ <function subprocess_started at 0x000001275948C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001275949B380>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000001275946B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001275949B380>
           │       └ <function run at 0x0000012758936CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000127594DC140>
           │      └ <function Runner.run at 0x0000012758AA1F80>
           └ <asyncio.runners.Runner object at 0x000001275949A750>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000012758A93A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001275949A750>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000012758A939C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000012758AA1800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000012758A05440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000012759499370>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031A30>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000127595A91C0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000012759499370>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031A30>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031A30>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001275C031340>
          └ <fastapi.applications.FastAPI object at 0x00000127595A91C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001275C06AB60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001275C031...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001275C0317C0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001275C031340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001275C06B420>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001275C031AF0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001275C0317C0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001275C0317C0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001275C031AF0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001275C06B420>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001275C0E0C20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001275C031790>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001275C0317C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001275C0E0C20>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001275C031A60>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001275C021D90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001275C031790>
          └ <function wrap_app_handling_exceptions at 0x000001275AE1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E1260>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001275C021D90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E1260>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001275C021D90>>
          └ <fastapi.routing.APIRouter object at 0x000001275C021D90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E1260>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001275AE1BA60>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E1260>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001275C06B1A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E1260>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001275C0BF500>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001275C0E13A0>
          └ <function wrap_app_handling_exceptions at 0x000001275AE1A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001275C0E14E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001275C06B2E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001275C0E13A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001275C0BF500>
                     └ <function get_request_handler.<locals>.app at 0x000001275C06B060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001275617A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001275C0BEDB0>}
                 │         └ <function get_cars at 0x000001275C06AF20>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001275BFCA090>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001275C0BEDB0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 74, in get_cars
    return [

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2833, in __iter__
    result = self._iter()
             │    └ <function Query._iter at 0x000001275BC74860>
             └ <sqlalchemy.orm.query.Query object at 0x000001275C104500>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
            │                  │    │      │      │    │       └ <function Session.execute at 0x000001275BCFC4A0>
            │                  │    │      │      │    └ <sqlalchemy.orm.session.Session object at 0x000001275C0BEDB0>
            │                  │    │      │      └ <sqlalchemy.orm.query.Query object at 0x000001275C104500>
            │                  │    │      └ ~_T
            │                  │    └ <class 'sqlalchemy.engine.result.Result'>
            │                  └ ~_T
            └ typing.Union
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x000001275BCFC180>
           └ <sqlalchemy.orm.session.Session object at 0x000001275C0BEDB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x000001275ACED800>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 293, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x000001275B9A7240>
             └ <sqlalchemy.engine.base.Connection object at 0x000001275C104DA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001275B9A7560>
           └ <sqlalchemy.engine.base.Connection object at 0x000001275C104DA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                │    └ <function ClauseElement._compile_w_cache at 0x000001275B7240E0>
                                                └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 705, in _compile_w_cache
    compiled_sql = self._compiler(
                   │    └ <function CompilerElement._compiler at 0x000001275B713060>
                   └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 317, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {'cache_key': CacheKey(key=('0', <class 'sqlalchemy.sql.selectable.Select'>, '_raw_columns', (('1', <class 'sqlalchemy.sql.an...
           │       │                  │        └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
           │       │                  └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001275BA693A0>
           │       └ <class 'sqlalchemy.dialects.postgresql.base.PGCompiler'>
           └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001275BA693A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1427, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {'schema_translate_map': None}
    │        │        │     │        └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
    │        │        │     └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001275BA693A0>
    │        │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
    │        └ <function Compiled.__init__ at 0x000001275B8E5F80>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
    │    │        │    └ <function Compiled.process at 0x000001275B8E6340>
    │    │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
           │   └ <function Visitable._generate_compiler_dispatch.<locals>._compiler_dispatch at 0x000001275B87B100>
           └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
           └ <bound method SQLCompiler.visit_select of <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4609, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    │           └ <bound method CompileState.create_for_statement of <class 'sqlalchemy.sql.base.CompileState'>>
                    └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           │     │                    │          │           └ {'within_columns_clause': False}
           │     │                    │          └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x000001275C1925D0>
           │     │                    └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
           │     └ <classmethod(<function ORMSelectCompileState.create_for_statement at 0x000001275ACEEC00>)>
           └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1162, in create_for_statement
    self._setup_for_generate()
    │    └ <function ORMSelectCompileState._setup_for_generate at 0x000001275ACEED40>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000001275C173D70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1197, in _setup_for_generate
    self._join(query._setup_joins, self._entities)
    │    │     │     │             │    └ [<sqlalchemy.orm.context._ORMColumnEntity object at 0x000001275C17D6C0>, <sqlalchemy.orm.context._ORMColumnEntity object at 0...
    │    │     │     │             └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000001275C173D70>
    │    │     │     └ ((Table('brands', MetaData(), Column('id', Integer(), table=<brands>, primary_key=True, nullable=False), Column('name', Strin...
    │    │     └ <sqlalchemy.sql.selectable.Select object at 0x000001275C030770>
    │    └ <function ORMSelectCompileState._join at 0x000001275ACEF920>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000001275C173D70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1834, in _join
    self._join_left_to_right(
    │    └ <function ORMSelectCompileState._join_left_to_right at 0x000001275ACEF9C0>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000001275C173D70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1869, in _join_left_to_right
    ) = self._join_determine_implicit_left_side(
        │    └ <function ORMSelectCompileState._join_determine_implicit_left_side at 0x000001275ACEFA60>
        └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000001275C173D70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 2024, in _join_determine_implicit_left_side
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.InvalidRequestError: Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
2024-01-14T01:29:45.816702+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:29:45.843740+0300 ERROR  Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002334F376660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002334F376700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 780
               │     └ 3
               └ <function _main at 0x000002334E168EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 780
           │    └ <function BaseProcess._bootstrap at 0x000002334E1276A0>
           └ <SpawnProcess name='SpawnProcess-2' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002334E126C00>
    └ <SpawnProcess name='SpawnProcess-2' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002334E13FB30>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=24560 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=24560 started>
    │    └ <function subprocess_started at 0x000002334ECAC0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=24560 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=616, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002334ECBB380>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=616, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002334EC8B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002334ECBB380>
           │       └ <function run at 0x000002334E156C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002334ECFC140>
           │      └ <function Runner.run at 0x000002334E2C1EE0>
           └ <asyncio.runners.Runner object at 0x000002334ECBA690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002334E2B39C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002334ECBA690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002334E2B3920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002334E2C1760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002334E2253A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002334ECD1E50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815B20>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002334E2D49B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002334ECD1E50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815B20>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815B20>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000023351815040>
          └ <fastapi.applications.FastAPI object at 0x000002334E2D49B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000233518520C0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000023351815...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000023351815850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000023351815040>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000023351853380>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000023351807980>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000023351815850>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000023351815850>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000023351807980>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000023351853380>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ InvalidRequestError("Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000233518CCF40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000233513E0230>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000023351815850>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000233518CCF40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000023351815B50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000233517E7110>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000233513E0230>
          └ <function wrap_app_handling_exceptions at 0x0000023350672700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000233517E7110>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD580>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000233517E7110>>
          └ <fastapi.routing.APIRouter object at 0x00000233517E7110>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD580>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000023350673560>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD580>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000233518531A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD580>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000233518AB7A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000233518CD6C0>
          └ <function wrap_app_handling_exceptions at 0x0000023350672700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000233518CD800>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000233518532E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000233518CD6C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000233518AB7A0>
                     └ <function get_request_handler.<locals>.app at 0x0000023351853060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002334B94A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000233518AB0B0>}
                 │         └ <function get_cars at 0x0000023351852F20>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000023350951B80>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000233518AB0B0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 66, in get_cars
    cars = str(

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\query.py", line 2877, in __str__
    return str(statement.compile(bind))
               │         │       └ Engine(postgresql+psycopg2://postgres:***@localhost:5555/postgres)
               │         └ <function CompilerElement.compile at 0x0000023350E5ACA0>
               └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 309, in compile
    return self._compiler(dialect, **kw)
           │    │         │          └ {}
           │    │         └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000233515E4BC0>
           │    └ <function CompilerElement._compiler at 0x0000023350E5AB60>
           └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\elements.py", line 317, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           │       │                  │        │       └ {}
           │       │                  │        └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
           │       │                  └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000233515E4BC0>
           │       └ <class 'sqlalchemy.dialects.postgresql.base.PGCompiler'>
           └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000233515E4BC0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1427, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    │        │        │     │        │            └ {}
    │        │        │     │        └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
    │        │        │     └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000233515E4BC0>
    │        │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
    │        └ <function Compiled.__init__ at 0x0000023351039A80>
    └ <class 'sqlalchemy.sql.compiler.Compiled'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 867, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
    │    │        │    │       │    │            └ immutabledict({})
    │    │        │    │       │    └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
    │    │        │    │       └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
    │    │        │    └ <function Compiled.process at 0x0000023351039E40>
    │    │        └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
    │    └ ''
    └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 912, in process
    return obj._compiler_dispatch(self, **kwargs)
           │   │                  │       └ {}
           │   │                  └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
           │   └ <function Visitable._generate_compiler_dispatch.<locals>._compiler_dispatch at 0x0000023350FBAC00>
           └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
           │    │       └ {}
           │    └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
           └ <bound method SQLCompiler.visit_select of <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4609, in visit_select
    compile_state = select_stmt._compile_state_factory(
                    │           └ <bound method CompileState.create_for_statement of <class 'sqlalchemy.sql.base.CompileState'>>
                    └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\base.py", line 687, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           │     │                    │          │           └ {'within_columns_clause': False}
           │     │                    │          └ <sqlalchemy.dialects.postgresql.base.PGCompiler object at 0x00000233518EC680>
           │     │                    └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
           │     └ <classmethod(<function ORMSelectCompileState.create_for_statement at 0x0000023351336C00>)>
           └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1162, in create_for_statement
    self._setup_for_generate()
    │    └ <function ORMSelectCompileState._setup_for_generate at 0x0000023351336D40>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002335184BD10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1197, in _setup_for_generate
    self._join(query._setup_joins, self._entities)
    │    │     │     │             │    └ [<sqlalchemy.orm.context._ORMColumnEntity object at 0x00000233518F8D40>, <sqlalchemy.orm.context._ORMColumnEntity object at 0...
    │    │     │     │             └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002335184BD10>
    │    │     │     └ ((Table('brands', MetaData(), Column('id', Integer(), table=<brands>, primary_key=True, nullable=False), Column('name', Strin...
    │    │     └ <sqlalchemy.sql.selectable.Select object at 0x00000233514764E0>
    │    └ <function ORMSelectCompileState._join at 0x0000023351337920>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002335184BD10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1834, in _join
    self._join_left_to_right(
    │    └ <function ORMSelectCompileState._join_left_to_right at 0x00000233513379C0>
    └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002335184BD10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 1869, in _join_left_to_right
    ) = self._join_determine_implicit_left_side(
        │    └ <function ORMSelectCompileState._join_determine_implicit_left_side at 0x0000023351337A60>
        └ <sqlalchemy.orm.context.ORMSelectCompileState object at 0x000002335184BD10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\context.py", line 2024, in _join_determine_implicit_left_side
    raise sa_exc.InvalidRequestError(
          │      └ <class 'sqlalchemy.exc.InvalidRequestError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.InvalidRequestError: Can't determine which FROM clause to join from, there are multiple FROMS which can join to this entity. Please use the .select_from() method to establish an explicit left side, as well as providing an explicit ON clause if not present already to help resolve the ambiguity.
2024-01-14T01:30:00.871894+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:35:16.756585+0300 ERROR  not enough values to unpack (expected 3, got 1)
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001471B936660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001471B936700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 756
               │     └ 3
               └ <function _main at 0x000001471A728EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 756
           │    └ <function BaseProcess._bootstrap at 0x000001471A6E76A0>
           └ <SpawnProcess name='SpawnProcess-1' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001471A6E6C00>
    └ <SpawnProcess name='SpawnProcess-1' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001471A6FFB30>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=8000 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=8000 started>
    │    └ <function subprocess_started at 0x000001471B26C0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001471B27B1D0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000001471B24B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001471B27B1D0>
           │       └ <function run at 0x000001471A716C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001471B2BC140>
           │      └ <function Runner.run at 0x000001471A881EE0>
           └ <asyncio.runners.Runner object at 0x000001471B27A5A0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001471A8739C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001471B27A5A0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001471A873920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001471A881760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001471A7E5300>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001471A3D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBDB80>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBD...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001471B389370>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001471A3D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBDB80>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBD...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBDB80>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBD...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001471DDBD490>
          └ <fastapi.applications.FastAPI object at 0x000001471B389370>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001471DDF20C0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001471DDBD...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001471DDBD880>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001471DDBD490>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001471DDF3380>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001471DDA79E0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001471DDBD880>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001471DDBD880>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001471DDA79E0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001471DDF3380>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ValueError('not enough values to unpack (expected 3, got 1)')
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001471EE3CF40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001471DDBD400>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001471DDBD880>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001471EE3CF40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001471DDBDBB0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001471DDA5A90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001471DDBD400>
          └ <function wrap_app_handling_exceptions at 0x000001471CC32700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D580>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001471DDA5A90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D580>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001471DDA5A90>>
          └ <fastapi.routing.APIRouter object at 0x000001471DDA5A90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D580>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001471CC33560>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D580>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001471DDF31A0>
          └ APIRoute(path='/items/cars', name='get_cars', methods=['GET'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D580>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001471EE1B830>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001471EE3D6C0>
          └ <function wrap_app_handling_exceptions at 0x000001471CC32700>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001471EE3D800>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001471DDF32E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001471EE3D6C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001471EE1B830>
                     └ <function get_request_handler.<locals>.app at 0x000001471DDF3060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000014717EAA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001471EE5C170>}
                 │         └ <function get_cars at 0x000001471DDF2F20>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001471DDA7110>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 72, in get_cars
    if result := Items(db=db).get_cars():
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001471EE5C170>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 80, in get_cars
    for power, brand_name, model_name in cars
                                         └ 'SELECT cars.power AS cars_power, brands.name AS brands_name, models.name AS models_name \nFROM cars JOIN brands ON brands.id...

ValueError: not enough values to unpack (expected 3, got 1)
2024-01-14T01:35:22.303533+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars
2024-01-14T01:35:22.362218+0300 INFO  Response: 200
2024-01-14T01:38:35.207698+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:38:35.211788+0300 INFO  Response: 200
2024-01-14T01:38:35.329500+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:38:35.345091+0300 INFO  Response: 200
2024-01-14T01:38:50.015331+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:38:50.020523+0300 INFO  Response: 200
2024-01-14T01:38:50.129725+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:38:50.145880+0300 INFO  Response: 200
2024-01-14T01:40:35.807810+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:40:35.807810+0300 INFO  Response: 200
2024-01-14T01:40:35.901980+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:40:35.918079+0300 INFO  Response: 200
2024-01-14T01:40:57.768940+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:40:57.772939+0300 INFO  Response: 200
2024-01-14T01:40:57.844505+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:40:57.861290+0300 INFO  Response: 200
2024-01-14T01:41:02.220439+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars_by_id?id=10
2024-01-14T01:41:02.278498+0300 INFO  Response: 404
2024-01-14T01:41:12.991139+0300 INFO  Request: GET http://127.0.0.1:8000/items/cars_by_id?id=20
2024-01-14T01:41:12.998161+0300 INFO  Response: 200
2024-01-14T01:45:13.347034+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T01:45:13.350035+0300 INFO  Response: 200
2024-01-14T01:45:13.461294+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T01:45:13.484640+0300 INFO  Response: 200
2024-01-14T01:45:23.237282+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:45:23.244761+0300 ERROR  Items.update_cars_by_id() missing 1 required positional argument: 'car_upd'
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001B767762480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001B767762520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 776
               │     └ 3
               └ <function _main at 0x000001B7654F8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 776
           │    └ <function BaseProcess._bootstrap at 0x000001B7654AF2E0>
           └ <SpawnProcess name='SpawnProcess-13' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001B7654AE840>
    └ <SpawnProcess name='SpawnProcess-13' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001B7654D3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-13' parent=8000 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-13' parent=8000 started>
    │    └ <function subprocess_started at 0x000001B76601BEC0>
    └ <SpawnProcess name='SpawnProcess-13' parent=8000 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001B76604A9F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=916, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001B76601B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001B76604A9F0>
           │       └ <function run at 0x000001B7654E6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001B76608C140>
           │      └ <function Runner.run at 0x000001B76564DD00>
           └ <asyncio.runners.Runner object at 0x000001B76604A3F0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001B7656437E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001B76604A3F0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001B765643740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001B76564D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001B7655B51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B766061130>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49580>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001B766160710>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001B766061130>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49580>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49580>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B768BE7440>
          └ <fastapi.applications.FastAPI object at 0x000001B766160710>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001B768BCB600>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001B768C49...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001B768BE7380>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001B768BE7440>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001B768C56F20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001B768C49D30>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001B768BE7380>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001B768BE7380>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001B768C49D30>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001B768C56F20>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ TypeError("Items.update_cars_by_id() missing 1 required positional argument: 'car_upd'")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001B768C61DA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B768BE72C0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001B768BE7380>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001B768C61DA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001B768C4BDA0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001B768B8DE50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001B768BE72C0>
          └ <function wrap_app_handling_exceptions at 0x000001B767A02520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C62020>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001B768B8DE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C62020>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001B768B8DE50>>
          └ <fastapi.routing.APIRouter object at 0x000001B768B8DE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C62020>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001B767A03380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C62020>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001B768BCACA0>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C62020>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001B768C4BFE0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001B768C62200>
          └ <function wrap_app_handling_exceptions at 0x000001B767A02520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001B768C623E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001B768C628E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001B768C62200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001B768C4BFE0>
                     └ <function get_request_handler.<locals>.app at 0x000001B768BCA980>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001B762CCA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000001B768BECEA0>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001B768BE6FF0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id):
                 │        │                     └ 20
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001B768C949E0>
                 └ <class 'app.shop.services.Items'>

TypeError: Items.update_cars_by_id() missing 1 required positional argument: 'car_upd'
2024-01-14T01:46:33.660185+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:46:33.719795+0300 ERROR  Class 'app.shop.schema.CarSchema' is not mapped
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3433, in add
    state = attributes.instance_state(instance)
            │          │              └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
            │          └ operator.attrgetter('_sa_instance_state')
            └ <module 'sqlalchemy.orm.attributes' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 761, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ '_sa_instance_state'
                                 └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)

AttributeError: 'CarSchema' object has no attribute '_sa_instance_state'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 808
               │     └ 3
               └ <function _main at 0x000001BD477D8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 808
           │    └ <function BaseProcess._bootstrap at 0x000001BD4778F2E0>
           └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001BD4778E840>
    └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001BD477B3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
    │    └ <function subprocess_started at 0x000001BD482FBEC0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=820, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001BD4832AA80>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=820, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001BD482FB4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001BD4832AA80>
           │       └ <function run at 0x000001BD477C6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001BD4836C140>
           │      └ <function Runner.run at 0x000001BD4792DD00>
           └ <asyncio.runners.Runner object at 0x000001BD48329CD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BD479237E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BD48329CD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001BD47923740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BD4792D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BD478951C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001BD4AC9F2C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57AD0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001BD49D00B90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001BD4AC9F2C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57AD0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57AD0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001BD4AE576E0>
          └ <fastapi.applications.FastAPI object at 0x000001BD49D00B90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001BD4AE36840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4AE57...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001BD4AE576E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001BD4AE36DE0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001BD4AE54D10>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001BD4AE54D10>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001BD4AE36DE0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ UnmappedInstanceError("Class 'app.shop.schema.CarSchema' is not mapped")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001BD4AED5BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001BD4AE55FA0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001BD4AED5BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001BD4AE57950>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001BD4AE55FA0>
          └ <function wrap_app_handling_exceptions at 0x000001BD49CE2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>>
          └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001BD49CE3380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001BD4AE36660>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001BD4AEB9790>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001BD4AED6340>
          └ <function wrap_app_handling_exceptions at 0x000001BD49CE2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED6480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4AED5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001BD4AED6340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001BD4AEB9790>
                     └ <function get_request_handler.<locals>.app at 0x000001BD4AE36C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001BD4500A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000001BD4AE5CE00>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001BD4AE571D0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 20
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001BD4AEBA360>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 105, in update_cars_by_id
    self.db.add(car)
    │    │  │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
    │    │  └ <function Session.add at 0x000001BD4AAA6020>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001BD4AEBA360>
    └ <app.shop.services.Items object at 0x000001BD4AEB9940>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3435, in add
    raise exc.UnmappedInstanceError(instance) from err
          │   │                     └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
          │   └ <class 'sqlalchemy.orm.exc.UnmappedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.UnmappedInstanceError: Class 'app.shop.schema.CarSchema' is not mapped
2024-01-14T01:47:05.617126+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:47:34.985460+0300 ERROR  Class 'app.shop.schema.CarSchema' is not mapped
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3433, in add
    state = attributes.instance_state(instance)
            │          │              └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
            │          └ operator.attrgetter('_sa_instance_state')
            └ <module 'sqlalchemy.orm.attributes' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 761, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ '_sa_instance_state'
                                 └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)

AttributeError: 'CarSchema' object has no attribute '_sa_instance_state'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 808
               │     └ 3
               └ <function _main at 0x000001BD477D8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 808
           │    └ <function BaseProcess._bootstrap at 0x000001BD4778F2E0>
           └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001BD4778E840>
    └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001BD477B3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
    │    └ <function subprocess_started at 0x000001BD482FBEC0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001BD4832AA80>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000001BD482FB4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001BD4832AA80>
           │       └ <function run at 0x000001BD477C6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001BD4836C140>
           │      └ <function Runner.run at 0x000001BD4792DD00>
           └ <asyncio.runners.Runner object at 0x000001BD48329CD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001BD479237E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001BD48329CD0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001BD47923740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001BD4792D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001BD478951C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001BD4AC9F2C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE8A0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001BD49D00B90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001BD4AC9F2C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE8A0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE8A0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001BD4AE576E0>
          └ <fastapi.applications.FastAPI object at 0x000001BD49D00B90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001BD4C3FDBC0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001BD4C3DE...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001BD4AE576E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001BD4C3FDD00>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001BD4C3DDF40>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001BD4C3DDF40>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001BD4C3FDD00>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ UnmappedInstanceError("Class 'app.shop.schema.CarSchema' is not mapped")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001BD4C3FDF80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001BD4AE55FA0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001BD4AE55A90>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001BD4C3FDF80>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001BD4AB9F110>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001BD4AE55FA0>
          └ <function wrap_app_handling_exceptions at 0x000001BD49CE2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED5DA0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED5DA0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>>
          └ <fastapi.routing.APIRouter object at 0x000001BD4ADFDD60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED5DA0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001BD49CE3380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED5DA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001BD4AE36660>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4AED5DA0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001BD4C3DDA90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001BD4AED5D00>
          └ <function wrap_app_handling_exceptions at 0x000001BD49CE2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001BD4C3FD8A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001BD4C3FDEE0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001BD4AED5D00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001BD4C3DDA90>
                     └ <function get_request_handler.<locals>.app at 0x000001BD4AE36C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001BD4500A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000001BD4AE5CE00>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001BD4AE571D0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 20
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001BD4C3DEFF0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 105, in update_cars_by_id
    self.db.add(car)
    │    │  │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
    │    │  └ <function Session.add at 0x000001BD4AAA6020>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001BD4C3DEFF0>
    └ <app.shop.services.Items object at 0x000001BD4C3DE4B0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3435, in add
    raise exc.UnmappedInstanceError(instance) from err
          │   │                     └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
          │   └ <class 'sqlalchemy.orm.exc.UnmappedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.UnmappedInstanceError: Class 'app.shop.schema.CarSchema' is not mapped
2024-01-14T01:47:43.044924+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:49:40.379480+0300 ERROR  __init__() takes 1 positional argument but 4 were given
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001C0B79A6660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001C0B79A6700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 756
               │     └ 3
               └ <function _main at 0x000001C0B6798EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 756
           │    └ <function BaseProcess._bootstrap at 0x000001C0B6747880>
           └ <SpawnProcess name='SpawnProcess-2' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001C0B6746DE0>
    └ <SpawnProcess name='SpawnProcess-2' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001C0B6753BF0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26792 started>
    │    └ <function subprocess_started at 0x000001C0B72DC0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=772, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001C0B72EB380>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=772, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001C0B72BB6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001C0B72EB380>
           │       └ <function run at 0x000001C0B6782C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001C0B732C140>
           │      └ <function Runner.run at 0x000001C0B68F1EE0>
           └ <asyncio.runners.Runner object at 0x000001C0B72EA690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001C0B68E39C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001C0B72EA690>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001C0B68E3920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001C0B68F1760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001C0B68553A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C0B673FFB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3B60>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001C0B8D919D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C0B673FFB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3B60>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3B60>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C0B9DE2F60>
          └ <fastapi.applications.FastAPI object at 0x000001C0B8D919D0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001C0B9E0A520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001C0B9DE3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001C0B9DE2E10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C0B9DE2F60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001C0B9E0A840>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001C0B9DE03B0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001C0B9DE2E10>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001C0B9DE2E10>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001C0B9DE03B0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001C0B9E0A840>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ TypeError('__init__() takes 1 positional argument but 4 were given')
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001C0BAE65BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C0B9DE2F00>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001C0B9DE2E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001C0BAE65BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001C0B977AE40>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001C0B9DC5D60>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C0B9DE2F00>
          └ <function wrap_app_handling_exceptions at 0x000001C0B8C7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001C0B9DC5D60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001C0B9DC5D60>>
          └ <fastapi.routing.APIRouter object at 0x000001C0B9DC5D60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001C0B8C7BA60>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001C0B9E0AD40>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001C0BAE51790>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001C0BAE66340>
          └ <function wrap_app_handling_exceptions at 0x000001C0B8C7A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C0BAE66480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001C0BAE65B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001C0BAE66340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001C0BAE51790>
                     └ <function get_request_handler.<locals>.app at 0x000001C0B9E0AB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001C0B3F1A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000001C0B9E20D60>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001C0B9DE3230>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 20
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001C0BAE52270>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 104, in update_cars_by_id
    car = Car(
          └ <class 'app.shop.models.Car'>

TypeError: __init__() takes 1 positional argument but 4 were given
2024-01-14T01:49:45.559529+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:49:45.637344+0300 INFO  Response: 404
2024-01-14T01:50:43.139379+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=20&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:50:43.216081+0300 INFO  Response: 404
2024-01-14T01:51:04.926505+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:51:04.942316+0300 INFO  Response: 404
2024-01-14T01:52:17.108939+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:52:17.185598+0300 ERROR  1 validation error for CarSchema
  Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=<app.shop.models.Car object at 0x000002787C55F170>, input_type=Car]
    For further information visit https://errors.pydantic.dev/2.5/v/model_type
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002787A0A2480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002787A0A2520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 752
               │     └ 3
               └ <function _main at 0x0000027877E38C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 752
           │    └ <function BaseProcess._bootstrap at 0x0000027877DEF2E0>
           └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000027877DEE840>
    └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000027877E13260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
    │    └ <function subprocess_started at 0x000002787895BEC0>
    └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=856, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002787898A840>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=856, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002787895B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000002787898A840>
           │       └ <function run at 0x0000027877E26980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000278789CC140>
           │      └ <function Runner.run at 0x0000027877F8DD00>
           └ <asyncio.runners.Runner object at 0x000002787898A210>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027877F837E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002787898A210>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000027877F83740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027877F8D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027877EF51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000278789B8230>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477AD0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002787A390560>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000278789B8230>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477AD0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477AD0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002787B4775C0>
          └ <fastapi.applications.FastAPI object at 0x000002787A390560>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002787B4A32E0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787B477...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002787B4775C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002787B4A2F20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002787B475070>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002787B475070>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002787B4A2F20>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 1 validation error for CarSchema
              Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002787C505940>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002787B477470>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002787C505940>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002787B4779B0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002787B477470>
          └ <function wrap_app_handling_exceptions at 0x000002787A342520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C505F80>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C505F80>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002787A6155E0>>
          └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C505F80>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002787A343380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C505F80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002787B4A2E80>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C505F80>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002787C4F1610>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002787C5060C0>
          └ <function wrap_app_handling_exceptions at 0x000002787A342520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787C506200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787C5058A0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002787C5060C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002787C4F1610>
                     └ <function get_request_handler.<locals>.app at 0x000002787B4A2980>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000278755CA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000002787B4BCB80>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002787B4770E0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002787C4F2180>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 109, in update_cars_by_id
    return CarSchema.model_validate(car)
           │         │              └ <app.shop.models.Car object at 0x000002787C55F170>
           │         └ <classmethod(<function BaseModel.model_validate at 0x0000027878D00900>)>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 503, in model_validate
    return cls.__pydantic_validator__.validate_python(
           │   │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
           │   └ SchemaValidator(title="CarSchema", validator=Model(
           │         ModelValidator {
           │             revalidate: Never,
           │             validator: ModelF...
           └ <class 'app.shop.schema.CarSchema'>

pydantic_core._pydantic_core.ValidationError: 1 validation error for CarSchema
  Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=<app.shop.models.Car object at 0x000002787C55F170>, input_type=Car]
    For further information visit https://errors.pydantic.dev/2.5/v/model_type
2024-01-14T01:52:33.699766+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:53:30.312810+0300 ERROR  1 validation error for CarSchema
  Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=<app.shop.models.Car object at 0x000002787CAECCB0>, input_type=Car]
    For further information visit https://errors.pydantic.dev/2.5/v/model_type
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002787A0A2480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002787A0A2520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 752
               │     └ 3
               └ <function _main at 0x0000027877E38C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 752
           │    └ <function BaseProcess._bootstrap at 0x0000027877DEF2E0>
           └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000027877DEE840>
    └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000027877E13260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
    │    └ <function subprocess_started at 0x000002787895BEC0>
    └ <SpawnProcess name='SpawnProcess-6' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002787898A840>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000002787895B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000002787898A840>
           │       └ <function run at 0x0000027877E26980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000278789CC140>
           │      └ <function Runner.run at 0x0000027877F8DD00>
           └ <asyncio.runners.Runner object at 0x000002787898A210>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027877F837E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002787898A210>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000027877F83740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027877F8D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027877EF51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000278789B8230>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C9338F0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C933...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002787A390560>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000278789B8230>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C9338F0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C933...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C9338F0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C933...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002787B4775C0>
          └ <fastapi.applications.FastAPI object at 0x000002787A390560>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002787CA98540>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002787C933...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002787B4775C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002787CA98680>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002787C932F30>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002787C932F30>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002787CA98680>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 1 validation error for CarSchema
              Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002787CA98900>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002787B477470>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002787B477530>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002787CA98900>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002787C933560>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002787B477470>
          └ <function wrap_app_handling_exceptions at 0x000002787A342520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98D60>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98D60>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002787A6155E0>>
          └ <fastapi.routing.APIRouter object at 0x000002787A6155E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98D60>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002787A343380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98D60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002787B4A2E80>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98D60>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002787C933C80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002787CA98E00>
          └ <function wrap_app_handling_exceptions at 0x000002787A342520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002787CA98F40>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002787CA98860>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002787CA98E00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002787C933C80>
                     └ <function get_request_handler.<locals>.app at 0x000002787B4A2980>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000278755CA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000002787B4BCB80>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002787B4770E0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002787CAEC110>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 109, in update_cars_by_id
    return CarSchema.model_validate(car)
           │         │              └ <app.shop.models.Car object at 0x000002787CAECCB0>
           │         └ <classmethod(<function BaseModel.model_validate at 0x0000027878D00900>)>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 503, in model_validate
    return cls.__pydantic_validator__.validate_python(
           │   │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
           │   └ SchemaValidator(title="CarSchema", validator=Model(
           │         ModelValidator {
           │             revalidate: Never,
           │             validator: ModelF...
           └ <class 'app.shop.schema.CarSchema'>

pydantic_core._pydantic_core.ValidationError: 1 validation error for CarSchema
  Input should be a valid dictionary or instance of CarSchema [type=model_type, input_value=<app.shop.models.Car object at 0x000002787CAECCB0>, input_type=Car]
    For further information visit https://errors.pydantic.dev/2.5/v/model_type
2024-01-14T01:53:36.123765+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:53:43.355590+0300 ERROR  3 validation errors for CarSchema
brand_name
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
model_name
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
power
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000002D7FE716660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000002D7FE716700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 756
               │     └ 3
               └ <function _main at 0x000002D7FD508EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 756
           │    └ <function BaseProcess._bootstrap at 0x000002D7FD4B7880>
           └ <SpawnProcess name='SpawnProcess-7' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002D7FD4B6DE0>
    └ <SpawnProcess name='SpawnProcess-7' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002D7FD4C3BC0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-7' parent=26792 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-7' parent=26792 started>
    │    └ <function subprocess_started at 0x000002D7FE04C0E0>
    └ <SpawnProcess name='SpawnProcess-7' parent=26792 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=844, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002D7FE05B5F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=844, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002D7FE02B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000002D7FE05B5F0>
           │       └ <function run at 0x000002D7FD4F2C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002D7FE09C140>
           │      └ <function Runner.run at 0x000002D7FD661EE0>
           └ <asyncio.runners.Runner object at 0x000002D7FE05AF00>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002D7FD6539C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002D7FE05AF00>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002D7FD653920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002D7FD661760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002D7FD5C53A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D7FD7A0950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3920>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000002D7FFA991F0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000002D7FD7A0950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3920>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3920>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D780CD2F30>
          └ <fastapi.applications.FastAPI object at 0x000002D7FFA991F0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D780CFA520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000002D780CD3...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000002D780CD2E10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D780CD2F30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D780CFA840>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D780CD18B0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000002D780CD2E10>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000002D780CD2E10>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002D780CD18B0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D780CFA840>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 3 validation errors for CarSchema
            brand_name
              Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x00...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D781D55BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D780CD2F00>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000002D780CD2E10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D781D55BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002D780CD39E0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002D7FFB62C00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D780CD2F00>
          └ <function wrap_app_handling_exceptions at 0x000002D7FF9EA2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002D7FFB62C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002D7FFB62C00>>
          └ <fastapi.routing.APIRouter object at 0x000002D7FFB62C00>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002D7FF9EBA60>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002D780CFAD40>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002D781D41880>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002D781D56340>
          └ <function wrap_app_handling_exceptions at 0x000002D7FF9EA2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D781D56480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D781D55B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002D781D56340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002D781D41880>
                     └ <function get_request_handler.<locals>.app at 0x000002D780CFAB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000002D7FACAA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000002D780D10D60>
                 └ <fastapi.dependencies.models.Dependant object at 0x000002D780CD33E0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002D781D42300>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 109, in update_cars_by_id
    return CarSchema.model_validate(car.__dict__)
           │         │              │   └ <attribute '__dict__' of 'Base' objects>
           │         │              └ <app.shop.models.Car object at 0x000002D781DAB380>
           │         └ <classmethod(<function BaseModel.model_validate at 0x000002D7FE3D0AE0>)>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 503, in model_validate
    return cls.__pydantic_validator__.validate_python(
           │   │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
           │   └ SchemaValidator(title="CarSchema", validator=Model(
           │         ModelValidator {
           │             revalidate: Never,
           │             validator: ModelF...
           └ <class 'app.shop.schema.CarSchema'>

pydantic_core._pydantic_core.ValidationError: 3 validation errors for CarSchema
brand_name
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
model_name
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
power
  Field required [type=missing, input_value={'_sa_instance_state': <s... at 0x000002D781D32B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T01:54:23.139486+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:54:29.958263+0300 ERROR  1 validation error for CarSchema
  JSON input should be string, bytes or bytearray [type=json_type, input_value={'_sa_instance_state': <s... at 0x000001FEC7EB2B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/json_type
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001FEC49CA660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001FEC49CA700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 644
               │     └ 3
               └ <function _main at 0x000001FEC37B8EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 644
           │    └ <function BaseProcess._bootstrap at 0x000001FEC3767880>
           └ <SpawnProcess name='SpawnProcess-1' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001FEC3766DE0>
    └ <SpawnProcess name='SpawnProcess-1' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001FEC3773BC0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=15592 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=15592 started>
    │    └ <function subprocess_started at 0x000001FEC42FC0E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=844, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001FEC430B5F0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=844, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001FEC42DB6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001FEC430B5F0>
           │       └ <function run at 0x000001FEC37A2C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001FEC434C140>
           │      └ <function Runner.run at 0x000001FEC4111EE0>
           └ <asyncio.runners.Runner object at 0x000001FEC430AF00>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001FEC41039C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001FEC430AF00>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001FEC4103920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001FEC4111760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001FEC40753A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FEC4250950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53920>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001FEC5DB91C0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FEC4250950>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53920>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53920>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FEC6E52EA0>
          └ <fastapi.applications.FastAPI object at 0x000001FEC5DB91C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001FEC6E7AC00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FEC6E53...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001FEC6E52DB0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FEC6E52EA0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FEC6E7B600>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001FEC6E528A0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001FEC6E52DB0>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001FEC6E52DB0>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001FEC6E528A0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FEC6E7B600>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 1 validation error for CarSchema
              JSON input should be string, bytes or bytearray [type=json_type, input_value={'_sa_instanc...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FEC7ED5BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FEC6E52BD0>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001FEC6E52DB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FEC7ED5BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001FEC6088DA0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001FEC6042060>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FEC6E52BD0>
          └ <function wrap_app_handling_exceptions at 0x000001FEC5C9A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001FEC6042060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001FEC6042060>>
          └ <fastapi.routing.APIRouter object at 0x000001FEC6042060>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001FEC5C9BA60>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001FEC6E7A7A0>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001FEC7EC1910>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001FEC7ED6340>
          └ <function wrap_app_handling_exceptions at 0x000001FEC5C9A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FEC7ED6480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FEC7ED5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001FEC7ED6340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001FEC7EC1910>
                     └ <function get_request_handler.<locals>.app at 0x000001FEC6E7A840>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001FEC0FFA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='asdas', model_name='asdas', power=444444.0), 'db': <sqlalchemy.orm.session.Session object at 0x...
                 │         └ <function update_cars_by_id at 0x000001FEC6E90D60>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001FEC6E53170>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 107, in update_cars_by_id
    if result := Items(db=db).update_cars_by_id(id, car):
                 │        │                     │   └ CarSchema(brand_name='asdas', model_name='asdas', power=444444.0)
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001FEC7EC2420>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 109, in update_cars_by_id
    return CarSchema.model_validate_json(car.__dict__)
           │         │                   │   └ <attribute '__dict__' of 'Base' objects>
           │         │                   └ <app.shop.models.Car object at 0x000001FEC7F2B380>
           │         └ <classmethod(<function BaseModel.model_validate_json at 0x000001FEC4680B80>)>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 532, in model_validate_json
    return cls.__pydantic_validator__.validate_json(json_data, strict=strict, context=context)
           │   │                      │             │                 │               └ None
           │   │                      │             │                 └ None
           │   │                      │             └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x000001FEC7EB2B70>}
           │   │                      └ <method 'validate_json' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
           │   └ SchemaValidator(title="CarSchema", validator=Model(
           │         ModelValidator {
           │             revalidate: Never,
           │             validator: ModelF...
           └ <class 'app.shop.schema.CarSchema'>

pydantic_core._pydantic_core.ValidationError: 1 validation error for CarSchema
  JSON input should be string, bytes or bytearray [type=json_type, input_value={'_sa_instance_state': <s... at 0x000001FEC7EB2B70>}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/json_type
2024-01-14T01:56:25.726946+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:56:27.525524+0300 ERROR  3 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response', 0), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('brand_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 1), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('model_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 2), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('power', 444444.0), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001D727666660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001D727666700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 696
               │     └ 3
               └ <function _main at 0x000001D726458EA0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 696
           │    └ <function BaseProcess._bootstrap at 0x000001D726407880>
           └ <SpawnProcess name='SpawnProcess-3' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001D726406DE0>
    └ <SpawnProcess name='SpawnProcess-3' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001D726413BC0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=15592 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=15592 started>
    │    └ <function subprocess_started at 0x000001D726F9C0E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=15592 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=816, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001D726FAB590>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=816, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001D726F7B6A0>
           │       │   └ <uvicorn.server.Server object at 0x000001D726FAB590>
           │       └ <function run at 0x000001D726442C00>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001D726FEC140>
           │      └ <function Runner.run at 0x000001D7265B1EE0>
           └ <asyncio.runners.Runner object at 0x000001D726FA9DF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001D7265A39C0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001D726FA9DF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001D7265A3920>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001D7265B1760>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001D7265153A0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D726107200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7BA10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7B...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001D726524B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001D726107200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7BA10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7B...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7BA10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7B...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D729B7AE40>
          └ <fastapi.applications.FastAPI object at 0x000001D726524B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001D729B62520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001D729B7B...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001D729B7AF30>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001D729B7AE40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001D729B62840>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001D729B7A750>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001D729B7AF30>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001D729B7AF30>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001D729B7A750>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001D729B62840>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ResponseValidationError()
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001D729BF5BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D729B7B770>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001D729B7AF30>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001D729BF5BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001D726FC0F20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001D729B247A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001D729B7B770>
          └ <function wrap_app_handling_exceptions at 0x000001D72893A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001D729B247A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001D729B247A0>>
          └ <fastapi.routing.APIRouter object at 0x000001D729B247A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001D72893BA60>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001D729B62D40>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001D729BE1730>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001D729BF6340>
          └ <function wrap_app_handling_exceptions at 0x000001D72893A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001D729BF6480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001D729BF5B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001D729BF6340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001D729BE1730>
                     └ <function get_request_handler.<locals>.app at 0x000001D729B62B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x000001D728939EE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 155, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 3 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response', 0), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('brand_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 1), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('model_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 2), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('power', 444444.0), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

2024-01-14T01:57:06.245681+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:58:22.931777+0300 ERROR  1 validation errors:
  {'type': 'list_type', 'loc': ('response',), 'msg': 'Input should be a valid list', 'input': <app.shop.models.Car object at 0x00000212D3B8FB00>, 'url': 'https://errors.pydantic.dev/2.5/v/list_type'}

Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000212D2642480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000212D2642520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 792
               │     └ 3
               └ <function _main at 0x00000212D03D8C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 792
           │    └ <function BaseProcess._bootstrap at 0x00000212D038F2E0>
           └ <SpawnProcess name='SpawnProcess-1' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000212D038E840>
    └ <SpawnProcess name='SpawnProcess-1' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000212D03B3260>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26136 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=26136 started>
    │    └ <function subprocess_started at 0x00000212D0EFBEC0>
    └ <SpawnProcess name='SpawnProcess-1' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=380, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000212D0F2AA50>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=380, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000212D0EFB4C0>
           │       │   └ <uvicorn.server.Server object at 0x00000212D0F2AA50>
           │       └ <function run at 0x00000212D03C6980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000212D0F6C140>
           │      └ <function Runner.run at 0x00000212D052DD00>
           └ <asyncio.runners.Runner object at 0x00000212D0F01220>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000212D05237E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000212D0F01220>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000212D0523740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000212D052D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000212D04951C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000212D3A808C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4800>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000212D3415BB0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000212D3A808C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4800>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4800>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000212D3A82AB0>
          └ <fastapi.applications.FastAPI object at 0x00000212D3415BB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000212D0F35E40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000212D3AE4...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000212D3A82960>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000212D3A82AB0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000212D0F36020>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000212D3A83CE0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000212D3A82960>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000212D3A82960>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000212D3A83CE0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000212D0F36020>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ResponseValidationError()
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000212D3B39E40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000212D3A82600>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000212D3A82960>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000212D3B39E40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000212D3AE45F0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000212D3A66120>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000212D3A82600>
          └ <function wrap_app_handling_exceptions at 0x00000212D28E2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000212D3A66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A480>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000212D3A66120>>
          └ <fastapi.routing.APIRouter object at 0x00000212D3A66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A480>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000212D28E3380>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A480>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000212D3AC3240>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A480>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000212D3B26000>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000212D3B3A5C0>
          └ <function wrap_app_handling_exceptions at 0x00000212D28E2520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000212D3B3A700>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000212D3B39DA0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000212D3B3A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000212D3B26000>
                     └ <function get_request_handler.<locals>.app at 0x00000212D3AC3100>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x00000212D28E2160>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 155, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'list_type', 'loc': ('response',), 'msg': 'Input should be a valid list', 'input': <app.shop.models.Car object at 0x00000212D3B8FB00>, 'url': 'https://errors.pydantic.dev/2.5/v/list_type'}

2024-01-14T01:58:34.777499+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:58:45.800530+0300 ERROR  3 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response', 0), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('brand_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 1), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('model_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 2), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('power', 444444.0), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000224B7346660>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000224B7346700>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 772
               │     └ 3
               └ <function _main at 0x00000224B6138F40>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 772
           │    └ <function BaseProcess._bootstrap at 0x00000224B60F7600>
           └ <SpawnProcess name='SpawnProcess-2' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000224B60F6B60>
    └ <SpawnProcess name='SpawnProcess-2' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000224B610F410>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26136 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=26136 started>
    │    └ <function subprocess_started at 0x00000224B6C7C0E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=26136 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=868, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000224B6C8ECF0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=868, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000224B6C5B6A0>
           │       │   └ <uvicorn.server.Server object at 0x00000224B6C8ECF0>
           │       └ <function run at 0x00000224B6126CA0>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000224B6CCC240>
           │      └ <function Runner.run at 0x00000224B6A91F80>
           └ <asyncio.runners.Runner object at 0x00000224B6C8EC30>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000224B6A83A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000224B6C8EC30>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000224B6A839C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000224B6A91800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000224B69F5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000224B96B6D80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B980>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000224B6A0CA70>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000224B96B6D80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B980>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B980>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000224B96B5AF0>
          └ <fastapi.applications.FastAPI object at 0x00000224B6A0CA70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000224B97BAD40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000224B978B...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000224B978B080>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000224B96B5AF0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000224B97BAC00>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000224B978A6C0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000224B978B080>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000224B978B080>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000224B978A6C0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000224B97BAC00>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ResponseValidationError()
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000224B9849BC0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000224B978B380>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000224B978B080>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000224B9849BC0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000224B978BA40>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000224B9752B70>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000224B978B380>
          └ <function wrap_app_handling_exceptions at 0x00000224B861A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A200>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000224B9752B70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A200>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000224B9752B70>>
          └ <fastapi.routing.APIRouter object at 0x00000224B9752B70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A200>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000224B861BA60>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A200>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000224B97BA7A0>
          └ APIRoute(path='/items/cars_by_id', name='update_cars_by_id', methods=['PUT'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A200>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000224B9831640>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000224B984A340>
          └ <function wrap_app_handling_exceptions at 0x00000224B861A2A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000224B984A480>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000224B9849B20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000224B984A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000224B9831640>
                     └ <function get_request_handler.<locals>.app at 0x00000224B97BA840>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x00000224B8619EE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 155, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 3 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response', 0), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('brand_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 1), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('model_name', 'asdas'), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}
  {'type': 'model_attributes_type', 'loc': ('response', 2), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': ('power', 444444.0), 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

2024-01-14T01:59:09.306008+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=asdas&model_name=asdas&power=444444
2024-01-14T01:59:09.396260+0300 INFO  Response: 200
2024-01-14T01:59:21.768219+0300 INFO  Request: PUT http://127.0.0.1:8000/items/cars_by_id?id=19&brand_name=11111111111&model_name=asdas&power=444444
2024-01-14T01:59:21.789876+0300 INFO  Response: 200
2024-01-14T02:03:13.206991+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T02:03:13.210057+0300 INFO  Response: 200
2024-01-14T02:03:13.343223+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T02:03:13.364482+0300 INFO  Response: 200
2024-01-14T02:03:30.772530+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:03:30.851456+0300 ERROR  1 validation error for CarSchema
power
  Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Mustang'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001FFAA692480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001FFAA692520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 752
               │     └ 3
               └ <function _main at 0x000001FFA8428C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 752
           │    └ <function BaseProcess._bootstrap at 0x000001FFA83DF2E0>
           └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001FFA83DE840>
    └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001FFA8403440>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
    │    └ <function subprocess_started at 0x000001FFA8F4BEC0>
    └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001FFA8F7A8D0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001FFA8F4B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001FFA8F7A8D0>
           │       └ <function run at 0x000001FFA8416980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001FFA8FBC140>
           │      └ <function Runner.run at 0x000001FFA857DD00>
           └ <asyncio.runners.Runner object at 0x000001FFA8F50CB0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001FFA85737E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001FFA8F50CB0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001FFA8573740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001FFA857D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001FFA84E51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FFA8E8AB10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8350>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001FFA85249B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FFA8E8AB10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8350>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8350>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FFABABE960>
          └ <fastapi.applications.FastAPI object at 0x000001FFA85249B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001FFABB1B600>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFABBC8...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FFABABE960>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FFABB3B100>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001FFABB86E70>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001FFABB86E70>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FFABB3B100>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 1 validation error for CarSchema
            power
              Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Must...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FFABB9EE80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FFABABE900>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FFABB9EE80>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001FFABBC9430>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FFABABE900>
          └ <function wrap_app_handling_exceptions at 0x000001FFAA932520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9EDE0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9EDE0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001FFABABDE50>>
          └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9EDE0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001FFAA933380>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9EDE0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001FFABB38180>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9EDE0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001FFABBC96A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001FFABB9E5C0>
          └ <function wrap_app_handling_exceptions at 0x000001FFAA932520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFABB9E840>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFABB9EA20>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001FFABB9E5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001FFABBC96A0>
                     └ <function get_request_handler.<locals>.app at 0x000001FFABB380E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001FFA5C1A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='Ford', model_name='Mustang', power=999.0), 'db': <sqlalchemy.orm.session.Session object at 0x00...
                 │         └ <function add_car at 0x000001FFABB19300>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001FFABB346B0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 124, in add_car
    if result := Items(db=db).add_cars(car):
                 │        │            └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001FFABBCA000>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 128, in add_cars
    return CarSchema(brand_name=car.brand.name, model_name=car.model.name)
           │                    │   │                      │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001FFABAF58A0>
           │                    │   │                      └ <app.shop.models.Car object at 0x000001FFABC1DD00>
           │                    │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001FFABAF5800>
           │                    └ <app.shop.models.Car object at 0x000001FFABC1DD00>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ CarSchema()
    │                 │                      │               └ {'brand_name': 'Ford', 'model_name': 'Mustang'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="CarSchema", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelF...
    └ CarSchema()

pydantic_core._pydantic_core.ValidationError: 1 validation error for CarSchema
power
  Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Mustang'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T02:03:57.687132+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:04:20.516961+0300 ERROR  1 validation error for CarSchema
power
  Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Mustang'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001FFAA692480>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001FFAA692520>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 752
               │     └ 3
               └ <function _main at 0x000001FFA8428C20>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 752
           │    └ <function BaseProcess._bootstrap at 0x000001FFA83DF2E0>
           └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001FFA83DE840>
    └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001FFA8403440>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
    │    └ <function subprocess_started at 0x000001FFA8F4BEC0>
    └ <SpawnProcess name='SpawnProcess-4' parent=1108 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001FFA8F7A8D0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000001FFA8F4B4C0>
           │       │   └ <uvicorn.server.Server object at 0x000001FFA8F7A8D0>
           │       └ <function run at 0x000001FFA8416980>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001FFA8FBC140>
           │      └ <function Runner.run at 0x000001FFA857DD00>
           └ <asyncio.runners.Runner object at 0x000001FFA8F50CB0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001FFA85737E0>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001FFA8F50CB0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001FFA8573740>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001FFA857D580>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001FFA84E51C0>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FFA8E8AB10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168D40>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001FFA85249B0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001FFA8E8AB10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168D40>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168D40>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FFABABE960>
          └ <fastapi.applications.FastAPI object at 0x000001FFA85249B0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001FFABC245E0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001FFAD168...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001FFABABE960>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FFAD10EAC0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001FFAD168320>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001FFAD168320>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001FFAD10EAC0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ 1 validation error for CarSchema
            power
              Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Must...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FFAD10EC00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FFABABE900>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001FFABABE870>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001FFAD10EC00>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001FFAD168E60>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001FFABABE900>
          └ <function wrap_app_handling_exceptions at 0x000001FFAA932520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F100>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F100>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001FFABABDE50>>
          └ <fastapi.routing.APIRouter object at 0x000001FFABABDE50>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F100>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001FFAA933380>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F100>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001FFABB38180>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F100>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001FFAD169130>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001FFAD10F1A0>
          └ <function wrap_app_handling_exceptions at 0x000001FFAA932520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001FFAD10F2E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001FFAD10EB60>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001FFAD10F1A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001FFAD169130>
                     └ <function get_request_handler.<locals>.app at 0x000001FFABB380E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001FFA5C1A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='Ford', model_name='Mustang', power=999.0), 'db': <sqlalchemy.orm.session.Session object at 0x00...
                 │         └ <function add_car at 0x000001FFABB19300>
                 └ <fastapi.dependencies.models.Dependant object at 0x000001FFABB346B0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 124, in add_car
    if result := Items(db=db).add_cars(car):
                 │        │            └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
                 │        └ <sqlalchemy.orm.session.Session object at 0x000001FFAD169730>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 128, in add_cars
    return CarSchema(brand_name=car.brand.name, model_name=car.model.name)
           │                    │   │                      │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001FFABAF58A0>
           │                    │   │                      └ <app.shop.models.Car object at 0x000001FFABB875F0>
           │                    │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001FFABAF5800>
           │                    └ <app.shop.models.Car object at 0x000001FFABB875F0>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ CarSchema()
    │                 │                      │               └ {'brand_name': 'Ford', 'model_name': 'Mustang'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="CarSchema", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelF...
    └ CarSchema()

pydantic_core._pydantic_core.ValidationError: 1 validation error for CarSchema
power
  Field required [type=missing, input_value={'brand_name': 'Ford', 'model_name': 'Mustang'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2024-01-14T02:04:38.108572+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:04:41.189092+0300 INFO  Response: 200
2024-01-14T02:07:21.777144+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:07:24.142667+0300 ERROR  Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are not accepted in this context; for comparison with a subquery, use Car.brand.has(**criteria).
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000240541B6700>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000240541B67A0>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 760
               │     └ 3
               └ <function _main at 0x0000024052FA8FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 760
           │    └ <function BaseProcess._bootstrap at 0x0000024052F7B9C0>
           └ <SpawnProcess name='SpawnProcess-1' parent=25692 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000024052F7AF20>
    └ <SpawnProcess name='SpawnProcess-1' parent=25692 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000024053A0BCB0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=25692 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=25692 started>
    │    └ <function subprocess_started at 0x0000024053AF0220>
    └ <SpawnProcess name='SpawnProcess-1' parent=25692 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=828, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000024053AFB4D0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=828, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000024053ACF740>
           │       │   └ <uvicorn.server.Server object at 0x0000024053AFB4D0>
           │       └ <function run at 0x0000024052F92D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000024053B3C340>
           │      └ <function Runner.run at 0x0000024053901F80>
           └ <asyncio.runners.Runner object at 0x0000024050B6EFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000240538F3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000024050B6EFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000240538F39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000024053901800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000024053861440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024050C9D970>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687350>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000024050B28B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024050C9D970>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687350>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687350>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000240566DA990>
          └ <fastapi.applications.FastAPI object at 0x0000024050B28B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000240566DF920>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000024056687...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000240566DA540>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000240566DA990>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000240566DF740>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000240566DBBC0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000240566DA540>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000240566DA540>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000240566DBBC0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000240566DF740>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ArgumentError('Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002405675E2A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000240566D9460>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000240566DA540>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002405675E2A0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000024056687D70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000024056685E80>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000240566D9460>
          └ <function wrap_app_handling_exceptions at 0x000002405547A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675E8E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000024056685E80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675E8E0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000024056685E80>>
          └ <fastapi.routing.APIRouter object at 0x0000024056685E80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675E8E0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000002405547BB00>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675E8E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000240567040E0>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675E8E0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002405674AAE0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002405675EA20>
          └ <function wrap_app_handling_exceptions at 0x000002405547A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002405675EB60>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000240566DF600>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002405675EA20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000002405674AAE0>
                     └ <function get_request_handler.<locals>.app at 0x0000024056704180>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000240507AA5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='Ford', model_name='Mustang', power=999.0), 'db': <sqlalchemy.orm.session.Session object at 0x00...
                 │         └ <function add_car at 0x00000240566DD3A0>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000240566FC710>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 124, in add_car
    if result := Items(db=db).add_cars(car):
                 │        │            └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
                 │        └ <sqlalchemy.orm.session.Session object at 0x000002405674B5F0>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 127, in add_cars
    Car.brand == car.brand_name
    │   │        │   └ 'Ford'
    │   │        └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
    │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000240566C58A0>
    └ <class 'app.shop.models.Car'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\operators.py", line 590, in __eq__
    return self.operate(eq, other)
           │    │       │   └ 'Ford'
           │    │       └ <built-in function eq>
           │    └ <function QueryableAttribute.operate at 0x00000240540458A0>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000240566C58A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 453, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
           │  │    │            │        └ {}
           │  │    │            └ ('Ford',)
           │  │    └ <member 'comparator' of 'QueryableAttribute' objects>
           │  └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000240566C58A0>
           └ <built-in function eq>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 760, in __eq__
    self.property._optimized_compare(
    │    └ <member 'property' of 'Comparator' objects>
    └ <sqlalchemy.orm.relationships.RelationshipProperty.Comparator object at 0x00000240566BC580>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1183, in _optimized_compare
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.ArgumentError: Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are not accepted in this context; for comparison with a subquery, use Car.brand.has(**criteria).
2024-01-14T02:10:29.515165+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:10:31.865197+0300 ERROR  Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are not accepted in this context; for comparison with a subquery, use Car.brand.has(**criteria).
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x0000021EF06BA700>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x0000021EF06BA7A0>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 776
               │     └ 3
               └ <function _main at 0x0000021EEF4A8FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 776
           │    └ <function BaseProcess._bootstrap at 0x0000021EEF47B9C0>
           └ <SpawnProcess name='SpawnProcess-1' parent=8736 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000021EEF47AF20>
    └ <SpawnProcess name='SpawnProcess-1' parent=8736 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000021EEFFCDC10>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=8736 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=8736 started>
    │    └ <function subprocess_started at 0x0000021EEFFF0220>
    └ <SpawnProcess name='SpawnProcess-1' parent=8736 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=764, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000021EEFFFB560>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=764, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000021EEFFD3740>
           │       │   └ <uvicorn.server.Server object at 0x0000021EEFFFB560>
           │       └ <function run at 0x0000021EEF492D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000021EF003C340>
           │      └ <function Runner.run at 0x0000021EEFE01F80>
           └ <asyncio.runners.Runner object at 0x0000021EED04EFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000021EEFDF3A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000021EED04EFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000021EEFDF39C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000021EEFE01800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000021EEFD61440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000021EED19DF70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87A70>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000021EED008B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000021EED19DF70>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87A70>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87A70>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000021EF2BA1430>
          └ <fastapi.applications.FastAPI object at 0x0000021EED008B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000021EF00059E0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000021EF2B87...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000021EF2BA1C40>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000021EF2BA1430>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000021EF2BE3740>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000021EF2BA3FE0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000021EF2BA1C40>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000021EF2BA1C40>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000021EF2BA3FE0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000021EF2BE3740>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ArgumentError('Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are ...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000021EF2C5E2A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000021EF2BA1640>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000021EF2BA1C40>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000021EF2C5E2A0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000021EF2B87740>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000021EF2B85CD0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000021EF2BA1640>
          └ <function wrap_app_handling_exceptions at 0x0000021EF197A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5E8E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000021EF2B85CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5E8E0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000021EF2B85CD0>>
          └ <fastapi.routing.APIRouter object at 0x0000021EF2B85CD0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5E8E0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000021EF197BB00>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5E8E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000021EF2C08720>
          └ APIRoute(path='/items/add_car', name='add_car', methods=['POST'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5E8E0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000021EF2C4AB10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000021EF2C5EA20>
          └ <function wrap_app_handling_exceptions at 0x0000021EF197A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000021EF2C5EB60>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000021EF2BE3600>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000021EF2C5EA20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000021EF2C4AB10>
                     └ <function get_request_handler.<locals>.app at 0x0000021EF2C087C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000021EECC8A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'car': CarSchema(brand_name='Ford', model_name='Mustang', power=999.0), 'db': <sqlalchemy.orm.session.Session object at 0x00...
                 │         └ <function add_car at 0x0000021EF2BE16C0>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000021EF2BF8B90>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 124, in add_car
    if result := Items(db=db).add_cars(car):
                 │        │            └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000021EF2C4B650>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 127, in add_cars
    Car.brand == car.brand_name,
    │   │        │   └ 'Ford'
    │   │        └ CarSchema(brand_name='Ford', model_name='Mustang', power=999.0)
    │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000021EF2BC98A0>
    └ <class 'app.shop.models.Car'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\sql\operators.py", line 590, in __eq__
    return self.operate(eq, other)
           │    │       │   └ 'Ford'
           │    │       └ <built-in function eq>
           │    └ <function QueryableAttribute.operate at 0x0000021EF05458A0>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000021EF2BC98A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 453, in operate
    return op(self.comparator, *other, **kwargs)  # type: ignore[no-any-return]  # noqa: E501
           │  │    │            │        └ {}
           │  │    │            └ ('Ford',)
           │  │    └ <member 'comparator' of 'QueryableAttribute' objects>
           │  └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000021EF2BC98A0>
           └ <built-in function eq>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 760, in __eq__
    self.property._optimized_compare(
    │    └ <member 'property' of 'Comparator' objects>
    └ <sqlalchemy.orm.relationships.RelationshipProperty.Comparator object at 0x0000021EF2BC06A0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1183, in _optimized_compare
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\\Lib...

sqlalchemy.exc.ArgumentError: Mapped instance expected for relationship comparison to object.   Classes, queries and other SQL elements are not accepted in this context; for comparison with a subquery, use Car.brand.has(**criteria).
2024-01-14T02:11:23.691736+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:11:27.897825+0300 INFO  Response: 200
2024-01-14T02:11:46.953386+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:11:49.726512+0300 INFO  Response: 200
2024-01-14T02:12:05.744119+0300 INFO  Request: POST http://127.0.0.1:8000/items/add_car?brand_name=Ford&model_name=Mustang&power=999
2024-01-14T02:12:07.558087+0300 INFO  Response: 404
2024-01-14T02:12:58.953641+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T02:12:58.957642+0300 INFO  Response: 200
2024-01-14T02:12:59.097813+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T02:12:59.119732+0300 INFO  Response: 200
2024-01-14T02:13:03.652728+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=19
2024-01-14T02:13:03.713986+0300 ERROR  Parent instance <Car at 0x11974e7b8f0> is not bound to a Session; lazy load operation of attribute 'brand' cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001197290A700>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001197290A7A0>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 680
               │     └ 3
               └ <function _main at 0x00000119716F8FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 680
           │    └ <function BaseProcess._bootstrap at 0x00000119716CB9C0>
           └ <SpawnProcess name='SpawnProcess-3' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000119716CAF20>
    └ <SpawnProcess name='SpawnProcess-3' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001197221DC10>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=28840 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=28840 started>
    │    └ <function subprocess_started at 0x0000011972240220>
    └ <SpawnProcess name='SpawnProcess-3' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001197224B7A0>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000011972223740>
           │       │   └ <uvicorn.server.Server object at 0x000001197224B7A0>
           │       └ <function run at 0x00000119716E2D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001197228C340>
           │      └ <function Runner.run at 0x0000011971851F80>
           └ <asyncio.runners.Runner object at 0x000001197224AFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000011971843A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001197224AFC0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000119718439C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000011971851800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000119717B5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000119713A7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16750>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001196F258B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000119713A7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16750>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16750>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000011974DA0F20>
          └ <fastapi.applications.FastAPI object at 0x000001196F258B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000011974DEBA60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000011974E16...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x0000011974DA1280>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000011974DA0F20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000011974D7AF20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000011974DDB860>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x0000011974DA1280>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x0000011974DA1280>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000011974DDB860>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000011974D7AF20>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ DetachedInstanceError("Parent instance <Car at 0x11974e7b8f0> is not bound to a Session; lazy load operation of attribute 'br...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000011974DFFBA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000011974DA1340>
          └ <app.utils.middleware.LoggingMiddleware object at 0x0000011974DA1280>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000011974DFFBA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000011974E14200>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000011974D26090>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000011974DA1340>
          └ <function wrap_app_handling_exceptions at 0x0000011973BCA340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFEE80>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000011974D26090>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFEE80>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000011974D26090>>
          └ <fastapi.routing.APIRouter object at 0x0000011974D26090>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFEE80>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000011973BCBB00>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFEE80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000011974D7A840>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFEE80>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000011974E15070>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000011974DFEB60>
          └ <function wrap_app_handling_exceptions at 0x0000011973BCA340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000011974DFF1A0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000011974DFF740>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000011974DFEB60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x0000011974E15070>
                     └ <function get_request_handler.<locals>.app at 0x0000011974D7AA20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001196EE8A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000011974E14E60>, 'id': 19}
                 │         └ <function delete_car at 0x0000011974D5FD80>
                 └ <fastapi.dependencies.models.Dependant object at 0x0000011974D7F6E0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 141, in delete_car
    if result := Items(db=db).delete_cars_by_id(id):
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x0000011974E14E60>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 121, in delete_cars_by_id
    return CarSchema(brand_name=car.brand.name, model_name=car.model.name)
           │                    │   │                      │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000011974D5DD00>
           │                    │   │                      └ <app.shop.models.Car object at 0x0000011974E7B8F0>
           │                    │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000011974D5DC60>
           │                    └ <app.shop.models.Car object at 0x0000011974E7B8F0>
           └ <class 'app.shop.schema.CarSchema'>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           │    │        │      └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x0000011974DDF5F0>, 'brand_id': 20, 'id': 19, 'updated_...
           │    │        └ <sqlalchemy.orm.state.InstanceState object at 0x0000011974DDF5F0>
           │    └ <member 'impl' of 'QueryableAttribute' objects>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000011974D5DC60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            │    │                      │      │    └ symbol('PASSIVE_OFF')
            │    │                      │      └ 'brand'
            │    │                      └ <sqlalchemy.orm.state.InstanceState object at 0x0000011974DDF5F0>
            │    └ <function AttributeImpl._fire_loader_callables at 0x0000011972797740>
            └ <sqlalchemy.orm.attributes.ScalarObjectAttributeImpl object at 0x0000011974E7D4E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1121, in _fire_loader_callables
    return self.callable_(state, passive)
           │    │         │      └ symbol('PASSIVE_OFF')
           │    │         └ <sqlalchemy.orm.state.InstanceState object at 0x0000011974DDF5F0>
           │    └ <member 'callable_' of 'AttributeImpl' objects>
           └ <sqlalchemy.orm.attributes.ScalarObjectAttributeImpl object at 0x0000011974E7D4E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\strategies.py", line 918, in _load_for_state
    raise orm_exc.DetachedInstanceError(
          │       └ <class 'sqlalchemy.orm.exc.DetachedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.DetachedInstanceError: Parent instance <Car at 0x11974e7b8f0> is not bound to a Session; lazy load operation of attribute 'brand' cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2024-01-14T02:13:46.485411+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=19
2024-01-14T02:13:46.541684+0300 ERROR  Class 'builtins.NoneType' is not mapped
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3494, in delete
    state = attributes.instance_state(instance)
            │          │              └ None
            │          └ operator.attrgetter('_sa_instance_state')
            └ <module 'sqlalchemy.orm.attributes' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-...

AttributeError: 'NoneType' object has no attribute '_sa_instance_state'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x00000226B5928FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x00000226B58FB9C0>
           └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000226B58FAF20>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000226B644DCA0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    └ <function subprocess_started at 0x00000226B6470220>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000226B647B620>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000226B6453740>
           │       │   └ <uvicorn.server.Server object at 0x00000226B647B620>
           │       └ <function run at 0x00000226B5912D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000226B64BC340>
           │      └ <function Runner.run at 0x00000226B6281F80>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000226B6273A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000226B62739C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000226B6281800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000226B61E5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5C10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5C10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5C10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
          └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000226B8FBC360>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226B8FD5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B8FBC9A0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000226B8F66A20>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000226B8F66A20>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B8FBC9A0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ UnmappedInstanceError("Class 'builtins.NoneType' is not mapped")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B903E7A0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B903E7A0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000226B8FD5AC0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903EDE0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903EDE0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000226B8F66120>>
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903EDE0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000226B7DFFB00>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903EDE0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000226B8FBC720>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903EDE0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000226B901B8F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000226B903EF20>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903F060>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B8FBC5E0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000226B903EF20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000226B901B8F0>
                     └ <function get_request_handler.<locals>.app at 0x00000226B8FBE520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000226B313A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000226B905C320>, 'id': 19}
                 │         └ <function delete_car at 0x00000226B8FA3C40>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000226B8FBAFC0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 141, in delete_car
    if result := Items(db=db).delete_cars_by_id(id):
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000226B905C320>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 119, in delete_cars_by_id
    self.db.delete(car)
    │    │  │      └ None
    │    │  └ <function Session.delete at 0x00000226B8C3E2A0>
    │    └ <sqlalchemy.orm.session.Session object at 0x00000226B905C320>
    └ <app.shop.services.Items object at 0x00000226B901BAA0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3496, in delete
    raise exc.UnmappedInstanceError(instance) from err
          │   │                     └ None
          │   └ <class 'sqlalchemy.orm.exc.UnmappedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
2024-01-14T02:14:01.774648+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=19
2024-01-14T02:14:22.063448+0300 ERROR  Class 'builtins.NoneType' is not mapped
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3494, in delete
    state = attributes.instance_state(instance)
            │          │              └ None
            │          └ operator.attrgetter('_sa_instance_state')
            └ <module 'sqlalchemy.orm.attributes' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-...

AttributeError: 'NoneType' object has no attribute '_sa_instance_state'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x00000226B5928FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x00000226B58FB9C0>
           └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000226B58FAF20>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000226B644DCA0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    └ <function subprocess_started at 0x00000226B6470220>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000226B647B620>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000226B6453740>
           │       │   └ <uvicorn.server.Server object at 0x00000226B647B620>
           │       └ <function run at 0x00000226B5912D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000226B64BC340>
           │      └ <function Runner.run at 0x00000226B6281F80>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000226B6273A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000226B62739C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000226B6281800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000226B61E5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604710>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604710>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604710>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
          └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000226B94D2980>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B94D2AC0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000226BA6041D0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000226BA6041D0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B94D2AC0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ UnmappedInstanceError("Class 'builtins.NoneType' is not mapped")
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B94D2C00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B94D2C00>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000226B90C7D10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903E980>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903E980>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000226B8F66120>>
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903E980>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000226B7DFFB00>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903E980>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000226B8FBC720>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B903E980>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000226B90C78F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000226B903E8E0>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226B94D2840>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D2B60>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000226B903E8E0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000226B90C78F0>
                     └ <function get_request_handler.<locals>.app at 0x00000226B8FBE520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000226B313A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000226B901BD10>, 'id': 19}
                 │         └ <function delete_car at 0x00000226B8FA3C40>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000226B8FBAFC0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 141, in delete_car
    if result := Items(db=db).delete_cars_by_id(id):
                 │        │                     └ 19
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000226B901BD10>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 119, in delete_cars_by_id
    self.db.delete(car)
    │    │  │      └ None
    │    │  └ <function Session.delete at 0x00000226B8C3E2A0>
    │    └ <sqlalchemy.orm.session.Session object at 0x00000226B901BD10>
    └ <app.shop.services.Items object at 0x00000226B90C7500>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\session.py", line 3496, in delete
    raise exc.UnmappedInstanceError(instance) from err
          │   │                     └ None
          │   └ <class 'sqlalchemy.orm.exc.UnmappedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
2024-01-14T02:14:24.798335+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=30
2024-01-14T02:14:24.815641+0300 ERROR  Parent instance <Car at 0x226ba60c0b0> is not bound to a Session; lazy load operation of attribute 'brand' cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x00000226B6B3A700>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x00000226B6B3A7A0>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 768
               │     └ 3
               └ <function _main at 0x00000226B5928FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 768
           │    └ <function BaseProcess._bootstrap at 0x00000226B58FB9C0>
           └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000226B58FAF20>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000226B644DCA0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
    │    └ <function subprocess_started at 0x00000226B6470220>
    └ <SpawnProcess name='SpawnProcess-5' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000226B647B620>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=792, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000226B6453740>
           │       │   └ <uvicorn.server.Server object at 0x00000226B647B620>
           │       └ <function run at 0x00000226B5912D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000226B64BC340>
           │      └ <function Runner.run at 0x00000226B6281F80>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000226B6273A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000226B647AFF0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000226B62739C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000226B6281800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000226B61E5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604EC0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000226B55D7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604EC0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604EC0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
          └ <fastapi.applications.FastAPI object at 0x00000226B34B8B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000226B94D3D80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x00000226BA604...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000226B8FD5040>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B94D3240>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000226BA6076B0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000226BA6076B0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000226B94D3240>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ DetachedInstanceError("Parent instance <Car at 0x226ba60c0b0> is not bound to a Session; lazy load operation of attribute 'br...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B8FBC5E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x00000226B81F2240>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000226B8FBC5E0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000226BA607650>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000226B8FD4F50>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C720>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C720>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000226B8F66120>>
          └ <fastapi.routing.APIRouter object at 0x00000226B8F66120>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C720>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x00000226B7DFFB00>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C720>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000226B8FBC720>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C720>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000226BA607260>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000226BA61C7C0>
          └ <function wrap_app_handling_exceptions at 0x00000226B7DFE340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000226BA61C900>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000226B94D3060>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000226BA61C7C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x00000226BA607260>
                     └ <function get_request_handler.<locals>.app at 0x00000226B8FBE520>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 299, in app
    raise e
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000226B313A5C0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000226BA607A40>, 'id': 30}
                 │         └ <function delete_car at 0x00000226B8FA3C40>
                 └ <fastapi.dependencies.models.Dependant object at 0x00000226B8FBAFC0>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\routers.py", line 141, in delete_car
    if result := Items(db=db).delete_cars_by_id(id):
                 │        │                     └ 30
                 │        └ <sqlalchemy.orm.session.Session object at 0x00000226BA607A40>
                 └ <class 'app.shop.services.Items'>

  File "c:\Users\foxra\Desktop\my_projects\test_work\app\shop\services.py", line 122, in delete_cars_by_id
    brand_name=car.brand.name,
               │   └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000226B8FA1940>
               └ <app.shop.models.Car object at 0x00000226BA60C0B0>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           │    │        │      └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x00000226BA5E6030>, 'brand_id': 7, 'id': 30, 'updated_a...
           │    │        └ <sqlalchemy.orm.state.InstanceState object at 0x00000226BA5E6030>
           │    └ <member 'impl' of 'QueryableAttribute' objects>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000226B8FA1940>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            │    │                      │      │    └ symbol('PASSIVE_OFF')
            │    │                      │      └ 'brand'
            │    │                      └ <sqlalchemy.orm.state.InstanceState object at 0x00000226BA5E6030>
            │    └ <function AttributeImpl._fire_loader_callables at 0x00000226B69C7380>
            └ <sqlalchemy.orm.attributes.ScalarObjectAttributeImpl object at 0x00000226B908CAE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1121, in _fire_loader_callables
    return self.callable_(state, passive)
           │    │         │      └ symbol('PASSIVE_OFF')
           │    │         └ <sqlalchemy.orm.state.InstanceState object at 0x00000226BA5E6030>
           │    └ <member 'callable_' of 'AttributeImpl' objects>
           └ <sqlalchemy.orm.attributes.ScalarObjectAttributeImpl object at 0x00000226B908CAE0>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\sqlalchemy\orm\strategies.py", line 918, in _load_for_state
    raise orm_exc.DetachedInstanceError(
          │       └ <class 'sqlalchemy.orm.exc.DetachedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Users\\foxra\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\test-work-d0cCIJjR-py3.12\...

sqlalchemy.orm.exc.DetachedInstanceError: Parent instance <Car at 0x226ba60c0b0> is not bound to a Session; lazy load operation of attribute 'brand' cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2024-01-14T02:16:07.065202+0300 INFO  Request: GET http://127.0.0.1:8000/docs
2024-01-14T02:16:07.071847+0300 INFO  Response: 200
2024-01-14T02:16:07.211009+0300 INFO  Request: GET http://127.0.0.1:8000/openapi.json
2024-01-14T02:16:07.226054+0300 INFO  Response: 200
2024-01-14T02:16:11.381123+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=3333333
2024-01-14T02:16:11.437548+0300 INFO  Response: 404
2024-01-14T02:16:14.425040+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=1
2024-01-14T02:16:14.432055+0300 INFO  Response: 404
2024-01-14T02:16:19.631146+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=15
2024-01-14T02:16:19.646862+0300 ERROR  1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': True, 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 97, in receive
    return self.receive_nowait()
           │    └ <function MemoryObjectReceiveStream.receive_nowait at 0x000001CB0474A700>
           └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 92, in receive_nowait
    raise WouldBlock
          └ <class 'anyio.WouldBlock'>

anyio.WouldBlock


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    message = await recv_stream.receive()
                    │           └ <function MemoryObjectReceiveStream.receive at 0x000001CB0474A7A0>
                    └ MemoryObjectReceiveStream(_state=MemoryObjectStreamState(max_buffer_size=0, buffer=deque([]), open_send_channels=0, open_rece...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\anyio\streams\memory.py", line 112, in receive
    raise EndOfStream
          └ <class 'anyio.EndOfStream'>

anyio.EndOfStream


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 760
               │     └ 3
               └ <function _main at 0x000001CB03538FE0>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 760
           │    └ <function BaseProcess._bootstrap at 0x000001CB0350B9C0>
           └ <SpawnProcess name='SpawnProcess-9' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001CB0350AF20>
    └ <SpawnProcess name='SpawnProcess-9' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001CB0405DC10>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=28840 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=28840 started>
    │    └ <function subprocess_started at 0x000001CB04080220>
    └ <SpawnProcess name='SpawnProcess-9' parent=28840 started>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=832, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001CB0408B560>>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=832, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001CB04063740>
           │       │   └ <uvicorn.server.Server object at 0x000001CB0408B560>
           │       └ <function run at 0x000001CB03522D40>
           └ <module 'asyncio' from 'C:\\Users\\foxra\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__.py'>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001CB040CC340>
           │      └ <function Runner.run at 0x000001CB03E91F80>
           └ <asyncio.runners.Runner object at 0x000001CB0408A930>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001CB03E83A60>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001CB0408A930>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 671, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001CB03E839C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 638, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001CB03E91800>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1971, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001CB03DF5440>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CB031E7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE7E0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x000001CB010E8B60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CB031E7200>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE7E0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE7E0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CB06C50E60>
          └ <fastapi.applications.FastAPI object at 0x000001CB010E8B60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001CB06D43BA0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x000001CB06CCE...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <app.utils.middleware.LoggingMiddleware object at 0x000001CB06C50C80>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CB06C50E60>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001CB06D40E00>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001CB06D2BFB0>
                     │    └ <bound method LoggingMiddleware.dispatch of <app.utils.middleware.LoggingMiddleware object at 0x000001CB06C50C80>>
                     └ <app.utils.middleware.LoggingMiddleware object at 0x000001CB06C50C80>

> File "c:\Users\foxra\Desktop\my_projects\test_work\app\utils\middleware.py", line 15, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001CB06D2BFB0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001CB06D40E00>

  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 165, in call_next
    raise app_exc
          └ ResponseValidationError()
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001CB06CAF100>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CB06C50F50>
          └ <app.utils.middleware.LoggingMiddleware object at 0x000001CB06C50C80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001CB06CAF100>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001CB06CCE810>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001CB06BD5F10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CB06C50F50>
          └ <function wrap_app_handling_exceptions at 0x000001CB05A0A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF240>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001CB06BD5F10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF240>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001CB06BD5F10>>
          └ <fastapi.routing.APIRouter object at 0x000001CB06BD5F10>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF240>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x000001CB05A0BB00>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF240>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001CB06C2A840>
          └ APIRoute(path='/items/delete_car', name='delete_car', methods=['DELETE'])
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF240>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001CB070C82C0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001CB06CAF380>
          └ <function wrap_app_handling_exceptions at 0x000001CB05A0A340>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001CB06CAF060>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001CB06D40FE0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001CB06CAF380>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\starlette\routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x000001CB070C82C0>
                     └ <function get_request_handler.<locals>.app at 0x000001CB06C2AA20>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 315, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x000001CB05A09F80>
  File "C:\Users\foxra\AppData\Local\pypoetry\Cache\virtualenvs\test-work-d0cCIJjR-py3.12\Lib\site-packages\fastapi\routing.py", line 155, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': True, 'url': 'https://errors.pydantic.dev/2.5/v/model_attributes_type'}

2024-01-14T02:17:09.240090+0300 INFO  Request: DELETE http://127.0.0.1:8000/items/delete_car?id=29
2024-01-14T02:17:09.311537+0300 INFO  Response: 200
